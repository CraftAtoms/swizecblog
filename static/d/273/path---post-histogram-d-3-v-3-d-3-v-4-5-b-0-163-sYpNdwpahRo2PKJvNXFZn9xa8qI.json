{"data":{"wordpressPost":{"title":"Histogram in D3v3 vs D3v4","content":"<p>D3v4 has been out since June. That’s almost five months. That’s also just long enough to make my React+D3.js ES6 book crazy outdated and to fill my inbox with emails saying, <em>&#8220;Yo, all your code is broken.”</em></p>\n<p>Yes, all my code is broken, and I&#8217;m <a href=\"https://swizec.com/blog/work-on-reactd3js-es6-v2-begins-in-earnest/swizec/7010\">working on an update </a>. There were a ton of changes in D3v4, but how different is it, really?</p>\n<p>Not that different! The <a href=\"https://swizec.com/blog/levenshtein-distance-in-haskell/swizec/4801\">Levenshtein distance</a> between a D3v3 histogram and a D3v4 histogram is only 82. It takes 82 1-character edits to go from a D3v3 histogram to a D3v4 histogram.</p>\n<p>That might sound like a bunch of edits, but the D3v4 example is a whopping 1026 characters. The D3v3 version is 1050.</p>\n<p>It’s 24 characters shorter and only 7.8% different. That doesn&#8217;t sound so bad, does it?</p>\n<p>Here&#8217;s a D3v3 histogram of a movie weekend dataset I found on a <a href=\"https://ww2.amstat.org/publications/jse/jse_data_archive.htm\">list of datasets by the Journal of Statistical Education</a>. It uses ES6 and pure D3 without React.</p>\n<p class='codepen'  data-height='265' data-theme-id='0' data-slug-hash='JRzWwj' data-default-tab='result' data-animations='run' data-editable='' data-embed-version='2'>\nSee the Pen <a href=\"http://codepen.io/swizec/pen/JRzWwj/\">Histogram D3v3</a> by Swizec Teller (<a href=\"http://codepen.io/swizec\">@swizec</a>) on <a href=\"http://codepen.io\">CodePen</a>.0</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>We load some data with <code>d3.tsv</code>, build a histogram with <code>d3.layout.histogram</code>, set up a linear scale for each axis, and add a <code>rect</code> to the SVG for each histogram entry.</p>\n<p>Now here’s the same dataset in D3v4:</p>\n<p class='codepen'  data-height='265' data-theme-id='0' data-slug-hash='wzOddx' data-default-tab='result' data-animations='run' data-editable='' data-embed-version='2'>\nSee the Pen <a href=\"http://codepen.io/swizec/pen/wzOddx/\">Histogram D3v4</a> by Swizec Teller (<a href=\"http://codepen.io/swizec\">@swizec</a>) on <a href=\"http://codepen.io\">CodePen</a>.0</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>Same unstyled result, and the code looks samey too.</p>\n<p>Here are the differences:</p>\n<ul>\n<li><code>d3.layout.histogram</code> becomes <code>d3.histogram</code></li>\n<li><code>.bins</code> becomes <code>.thresholds</code></li>\n<li><code>d3.scale.linear</code> becomes <code>d3.scaleLinear</code></li>\n<li><code>d.x+d.dx</code> becomes <code>d.x1</code></li>\n<li><code>d.y</code> becomes <code>d.length</code></li>\n<li><code>d.dx</code> becomes <code>d.x1-d.x0</code></li>\n</ul>\n<p>Some of the API has been moved around and renamed to make more sense. Thresholds make more sense than bins, but scaleLinear vs. scale.linear… eh… sure. ¯_(ツ)<em>/¯<br />\n</em></p>\n<p>The biggest difference lies in histogram&#8217;s return value. Where before we would get an array of arrays with additional <code>x</code>, <code>y</code>, and <code>dx</code> values, we now get just <code>x0</code> and <code>x1</code>.</p>\n<p>I like the <code>x0, x1</code> approach because it tells us the lower and upper bound of each interval. This means less typing and thinking overhead in all cases except for one – when you do need the width. And I like the idea of relying on <code>length</code> instead of having an extra <code>y</code> property that&#8217;s the same as <code>length</code>.</p>\n<p>I like all the changes, and I think they improve the library by leaps and bounds. But it&#8217;s these subtle differences that are the most annoying to catch.</p>\n<p>Curiously, D3v3 calculates a bin width of 1962.5, and D3v4 gets 2000. Same data, same amount of bins. ?</p>\n<p>Want more about the differences between D3v3 and D3v4? I&#8217;m thinking of making a cheatsheet. <a href=\"https://twitter.com/intent/tweet?url=http%3A%2F%2Fswizec.com%2Fblog%2Fhistogram-d3v3-d3v4%2Fswizec%2F7145&amp;text=Hey%20@swizec%21%20Where%27s%20that%20d3%20cheatsheet%20you%20promised%3F&amp;\">Encourage me on Twitter</a>.</p>\n"},"site":{"siteMetadata":{"title":"Swizec Blog","subtitle":"Fetch Data From Local WP Install"}}},"pageContext":{"id":"43e9e71d-0be2-5fba-be2e-bb29c1e2df5e"}}