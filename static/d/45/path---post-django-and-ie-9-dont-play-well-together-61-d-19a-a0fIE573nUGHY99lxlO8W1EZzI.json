{"data":{"wordpressPost":{"title":"Django and IE9 don&#8217;t play well together","content":"<p>You know those bugs that take<em> hours</em> to debug? And the fix is &#8230; <em>moving a single line.</em></p>\n<div style=\"width: 250px\" class=\"wp-caption alignright\"><a href=\"http://www.flickr.com/photos/43963088@N03/6935959929\" target=\"_blank\"><img class=\"zemanta-img-inserted zemanta-img-configured\" title=\"filming of the HTML music video\" src=\"http://farm8.static.flickr.com/7054/6935959929_a80f9166c9_m.jpg\" alt=\"filming of the HTML music video\" width=\"240\" height=\"180\" /></a><p class=\"wp-caption-text\">filming of the HTML music video (Photo credit: MadLabUK)</p></div>\n<p>That kind of bug is tripped up when you use django&#8217;s csrf protection and someone comes to your site using <a class=\"zem_slink\" title=\"Internet Explorer 9\" href=\"http://ie9.com\" rel=\"homepage\" target=\"_blank\">IE9</a>. It can easily happen that not only will form stylings not affect the elements, the form might even ignore any values entered!</p>\n<p>But it works perfectly on older versions of IE.</p>\n<p>The bug was insanely difficult to pinpoint because I don&#8217;t have IE9 anywhere &#8211; only linux and mac around here, any windows box is so old IE7 is about the extent of its capabilities &#8230; After installing some sort of windows 7 to a <a class=\"zem_slink\" title=\"Virtual machine\" href=\"http://en.wikipedia.org/wiki/Virtual_machine\" rel=\"wikipedia\" target=\"_blank\">virtual machine</a> and getting IE9 working, I set to work.</p>\n<h2>Symptoms</h2>\n<ol>\n<li>Form works perfectly in IE7, <a class=\"zem_slink\" title=\"Google Chrome\" href=\"http://www.google.com/chrome\" rel=\"homepage\" target=\"_blank\">Chrome</a>, Firefox etc.</li>\n<li>Form works perfectly with <em><a class=\"zem_slink\" title=\"Compatibility mode\" href=\"http://en.wikipedia.org/wiki/Compatibility_mode\" rel=\"wikipedia\" target=\"_blank\">compatibility mode</a></em> turned on</li>\n<li>Form values aren&#8217;t submitted</li>\n<li>Form elements don&#8217;t respond to form styling</li>\n</ol>\n<p>For some reason IE9 thinks the form is empty. Displays all elements, but they don&#8217;t behave like they&#8217;re part of the form &#8230; which is kind of odd. They aren&#8217;t even selectable through the <a class=\"zem_slink\" title=\"Firefox\" href=\"http://www.mozilla.com/firefox/\" rel=\"homepage\" target=\"_blank\">javascript console</a> or anything.</p>\n<h2>Solution</h2>\n<p>After many pointless wanderings and random code changes, I realized the <a class=\"zem_slink\" title=\"HTML\" href=\"http://en.wikipedia.org/wiki/HTML\" rel=\"wikipedia\" target=\"_blank\">HTML</a>doesn&#8217;t look like something I&#8217;d usually write (legacy-ish code).</p>\n<pre lang=\"html\">\r\n<form action=\"/somewhere\" method=\"POST\">\r\n{% csrf_token %} \r\n<label>blah</label><input type=\"text\" name=\"blah\" /> \r\n<!-- etc -->\r\n</form>\r\n</pre>\n<p>Usually I&#8217;d put the {% <em>csrf_token %}</em> at the end. Not sure why, just the way I&#8217;ve always done it &#8230; surely this can&#8217;t make a difference right?</p>\n<p>It can!</p>\n<p>Putting it at the bottom of the form fixed all bugs. Styling suddenly worked, form was submitted with all data and everything worked everywhere.</p>\n<h2>Le huh?</h2>\n<div style=\"width: 250px\" class=\"wp-caption alignright\"><a href=\"http://www.flickr.com/photos/43963088@N03/6935959333\" target=\"_blank\"><img class=\"zemanta-img-inserted zemanta-img-configured\" title=\"filming of the HTML music video\" src=\"http://farm8.static.flickr.com/7204/6935959333_484df58faa_m.jpg\" alt=\"filming of the HTML music video\" width=\"240\" height=\"180\" /></a><p class=\"wp-caption-text\">filming of the HTML music video (Photo credit: MadLabUK)</p></div>\n<p>When the form is rendered that <em> {% csrf_token %}</em> is replaced with an invisible <a class=\"zem_slink\" title=\"Span and div\" href=\"http://en.wikipedia.org/wiki/Span_and_div\" rel=\"wikipedia\" target=\"_blank\">div tag</a>. For some reason this ticks off IE9&#8217;s strictness and the rest of the form isn&#8217;t considered to be a part of this element anymore.</p>\n<p>Something like this:</p>\n<pre lang=\"html\">\r\n<form method=\"POST\" class=\"filter\" style=\"display: none\">\r\n    <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='41aeb46067bf9e800f9ce6c718265121' /></div>\r\n    <input type=\"hidden\" name=\"selected\" value=\"\" />\r\n    <label for=\"dateFrom\">From date:</label>\r\n    <input type=\"text\" class=\"datepicker\" name=\"dateFrom\" readonly=\"readonly\" value=\"\"/>\r\n    <!-- etc. -->\r\n</form>\r\n</pre>\n<p>I can&#8217;t find official reference either way, but I think div&#8217;s inside forms are legal HTML, perhaps not the best looking HTML, but <em>p</em> tags are allowed, even happen in the<a href=\"http://www.w3.org/TR/html401/interact/forms.html#h-17.4.2\"> form tag example on w3.org</a>, so I have no idea why IE9 would trip up on this.</p>\n<p>Perhaps someone a bit more knowledgeable of strict HTML can shed some light on this issue? For now, let&#8217;s all just be aware of this little quirk.</p>\n<h6 class=\"zemanta-related-title\" style=\"font-size: 1em;\">Related articles</h6>\n<ul class=\"zemanta-article-ul\">\n<li class=\"zemanta-article-ul-li\"><a href=\"http://browserfame.com/543/microsoft-makes-fun-of-internet-explorer-older-versions\" target=\"_blank\">Microsoft Makes Fun of Older IE versions To Promote IE9</a> (browserfame.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://www.edugeek.net/forums/windows-7/91141-ie9-e-portal.html\" target=\"_blank\">IE9 and e-Portal</a> (edugeek.net)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://browserfame.com/528/pwn2own-2012-pwnium-chrome-ie9-firefox\" target=\"_blank\">Chrome, IE9 and Firefox Failed at Pwn2Own 2012</a> (browserfame.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://stackoverflow.com/questions/9298929/rounded-corners-not-working-in-ie9\" target=\"_blank\">Rounded corners not working in IE9</a> (stackoverflow.com)</li>\n</ul>\n<div class=\"zemanta-pixie\" style=\"margin-top: 10px; height: 15px;\"><a class=\"zemanta-pixie-a\" title=\"Enhanced by Zemanta\" href=\"http://www.zemanta.com/\"><img class=\"zemanta-pixie-img\" style=\"border: none; float: right;\" src=\"http://img.zemanta.com/zemified_e.png?x-id=5c714ca9-738a-4e4e-afcc-841f303b60b4\" alt=\"Enhanced by Zemanta\" /></a></div>\n"},"site":{"siteMetadata":{"title":"Swizec Blog","subtitle":"Fetch Data From Local WP Install"}}},"pageContext":{"id":"168a2d2e-d1a1-5875-94b8-16687cf6be55"}}