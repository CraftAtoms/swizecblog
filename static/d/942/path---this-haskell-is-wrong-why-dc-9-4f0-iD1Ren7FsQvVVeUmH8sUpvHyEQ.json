{"data":{"wordpressPost":{"title":"This Haskell is wrong. Why?","content":"<div style=\"width: 310px\" class=\"wp-caption alignright\"><a href=\"http://en.wikipedia.org/wiki/File:5-cube_scrambled.png\"><img class=\"zemanta-img-inserted zemanta-img-configured\" title=\"English: 5D virtual 3^5 sequential move puzzle...\" src=\"http://swizec.com/blog/wp-content/uploads/2012/01/300px-5-cube_scrambled2.png\" alt=\"English: 5D virtual 3^5 sequential move puzzle...\" width=\"300\" height=\"293\" /></a><p class=\"wp-caption-text\">Image via Wikipedia</p></div>\n<p>The problem I&#8217;m trying to solve is the simple but lovely <a href=\"http://projecteuler.net/problem=62\" target=\"_blank\">euler 62</a>.</p>\n<blockquote><p>The cube, 41063625 (345<sup>3</sup>), can be permuted to produce two other cubes: 56623104 (384<sup>3</sup>) and 66430125 (405<sup>3</sup>). In fact, 41063625 is the smallest cube which has exactly three permutations of its digits which are also cube.</p>\n<p>Find the smallest cube for which exactly five permutations of its digits are cube.</p></blockquote>\n<p>A bit of fun coding after a statistics midterm last night and the solution should be in the bag. Except it isn&#8217;t, I am doing something wrong somehow and I can&#8217;t figure out what! Hopefully someone a bit better than me can shed some light whether my proposed solution is wrong or I just suck at <a class=\"zem_slink\" title=\"Haskell (programming language)\" href=\"http://haskell.org\" rel=\"homepage\">Haskell</a>.</p>\n<h2>Algorithm</h2>\n<ol>\n<li>Generate cubes up to 10,000</li>\n<li>Every cube is a pair of a digit-ordered string <em>n^3</em>Â and <em>n, </em>for instance <em>(&#8220;279&#8221;,9)</em></li>\n<li>Order cubes by the string number presentation</li>\n<li>Group together all cubes with the same <em>n^3</em></li>\n<li>Pick out groups with the size of 5</li>\n<li>Sort by <em>n</em></li>\n<li>Pick the smallest number</li>\n</ol>\n<p>Should work in principle right? So why doesn&#8217;t the website accept my answer <em>(5027)</em>? My guess is I&#8217;m doing something wrong in the sorting and grouping department and I was hoping someone with a bit more knowledge of Haskell could point out where I&#8217;m being stupid.</p>\n<h2>Code</h2>\n<pre lang=\"haskell\">\r\nimport Data.List\r\n\r\ncubes::(Num a) => a -> [(String, a)]\r\ncubes 1 = [(show 1, 1)]\r\ncubes n = (sort$show(n^3), n):(cubes $ n-1)\r\n\r\nsortStrNum (s1, n1) (s2, n2)\r\n  | length s1 == length s2 = compare s1 s2\r\n  | otherwise = compare (length s1) (length s2)\r\n\r\npermuted_cubes n =\r\n  groupBy (\\a b -> fst a == fst b) $ sortBy sortStrNum $ cubes n\r\n\r\nfives n =\r\n  filter (\\xs -> length xs == 5) $ permuted_cubes n\r\n\r\ncomparing p x y = compare (p x) (p y)\r\n\r\nsmallest =\r\n  head $ sortBy (comparing snd) $ head $ fives 100000\r\n\r\n</pre>\n<p>The whole thing looks kind of alright to me, no matter how much I poke around it doesn&#8217;t seem like something is misbehaving &#8230; but it still is.</p>\n<p>Ideas?</p>\n<h6 class=\"zemanta-related-title\" style=\"font-size: 1em;\">Related articles</h6>\n<ul class=\"zemanta-article-ul\">\n<li class=\"zemanta-article-ul-li\"><a href=\"http://swizec.com/blog/collatz-haskell-and-memoization/swizec/3382\">Collatz, Haskell and Memoization</a> (swizec.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://swizec.com/blog/learning-me-a-haskell/swizec/3272\">Learning me a Haskell</a> (swizec.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://stackoverflow.com/questions/8905037/converting-haskell-polymorphic-cosine-function-to-f\">Converting Haskell Polymorphic Cosine function to F#</a> (stackoverflow.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://stackoverflow.com/questions/8155929/mutable-possibly-parallel-haskell-code-and-performance-tuning\">Mutable, (possibly parallel) Haskell code and performance tuning</a> (stackoverflow.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://stackoverflow.com/questions/8275171/will-this-haskell-code-take-too-much-memory\">Will this Haskell code take too much memory?</a> (stackoverflow.com)</li>\n<li class=\"zemanta-article-ul-li\"><a href=\"http://stackoverflow.com/questions/8751188/exceptions-in-haskell\">Exceptions in Haskell</a> (stackoverflow.com)</li>\n</ul>\n<div class=\"zemanta-pixie\" style=\"margin-top: 10px; height: 15px;\"><a class=\"zemanta-pixie-a\" title=\"Enhanced by Zemanta\" href=\"http://www.zemanta.com/\"><img class=\"zemanta-pixie-img\" style=\"border: none; float: right;\" src=\"http://img.zemanta.com/zemified_e.png?x-id=727c4e4d-a97d-47a9-a6d5-d7017d2e3bfe\" alt=\"Enhanced by Zemanta\" /></a></div>\n"},"site":{"siteMetadata":{"title":"Swizec Blog","subtitle":"Fetch Data From Local WP Install"}}},"pageContext":{"id":"645320ae-aa72-536c-bd9b-2d98291ef8cf"}}