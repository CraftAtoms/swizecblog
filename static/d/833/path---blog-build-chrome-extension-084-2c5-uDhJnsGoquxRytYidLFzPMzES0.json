{"data":{"wordpressPost":{"title":"Build a Chrome extension from idea to launch in an afternoon","content":"<p><em>This is a Livecoding Recap ‚Äì an almost-weekly post about interesting things discovered while livecoding. Usually shorter than 500 words. Often with pictures. Livecoding happens almost <strong>every Sunday at 2pm PDT</strong> on multiple channels. You should subscribe to <a href=\"https://www.youtube.com/TheSwizec\">My Youtube</a> channel to catch me live.</em></p>\n<p><iframe width=\"580\" height=\"326\" src=\"https://www.youtube.com/embed/I7ibjBQtcQE?feature=oembed\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe></p>\n<p>One of my most pointless timesucks is <a href=\"https://imgur.com\">imgur.com</a>.</p>\n<p>Maybe you don&#8217;t know what that is, or think it&#8217;s an image host for Reddit and never realized it&#8217;s got a homepage. <a href=\"https://www.buzzfeed.com/jwherrman/imgur-is-now-bigger-than-reddit\">Imgur is bigger than Reddit</a>, actually.</p>\n<p>That&#8217;s news from 5 years ago. ü§î Am I not hip with the kids anymore?</p>\n<img src=\"https://media.giphy.com/media/ifxLK48cnyDDi/giphy.gif\" />\n<p>Either way, Imgur is great. Full of fun images, crap comments, and there&#8217;s always the next gif to see. Sometimes world news.</p>\n<p>You open it up, it greets you with enticing thumbnails and before you know it, it&#8217;s 20 minutes later and you&#8217;re waaaaay past your break time.</p>\n<img class=\"alignnone size-full wp-image-8276\" src=\"https://swizec.com/blog/wp-content/uploads/2018/03/imgur_home_page-3.png\" width=\"3360\" height=\"1908\" srcset=\"https://swizec.com/blog/wp-content/uploads/2018/03/imgur_home_page-3.png 3360w, https://swizec.com/blog/wp-content/uploads/2018/03/imgur_home_page-3-300x170.png 300w, https://swizec.com/blog/wp-content/uploads/2018/03/imgur_home_page-3-768x436.png 768w, https://swizec.com/blog/wp-content/uploads/2018/03/imgur_home_page-3-1024x581.png 1024w\" sizes=\"(max-width: 3360px) 100vw, 3360px\" />\n<p>I built <a href=\"#\">hideimgur.com</a> to fix that. It‚Äôs a Chrome extension that replaces Imgur&#8217;s homepage with tips for taking a healthy break. Sometimes it tells you to do push ups, sometimes to go chat with a human being. It&#8217;s great.</p>\n<p>And no more imgur addiction. Fixed me in 2 days! üëå</p>\n<p><a href=\"http://hideimgur.com\"><div id=\"attachment_8274\" style=\"width: 2188px\" class=\"wp-caption alignnone\"><img class=\"alignnone size-full wp-image-8274\" src=\"https://swizec.com/blog/wp-content/uploads/2018/03/hide-imgur-homepage-1.png\" alt=\"HideImgur replaces the homepage with useful tips\" width=\"2178\" height=\"1596\" srcset=\"https://swizec.com/blog/wp-content/uploads/2018/03/hide-imgur-homepage-1.png 2178w, https://swizec.com/blog/wp-content/uploads/2018/03/hide-imgur-homepage-1-300x220.png 300w, https://swizec.com/blog/wp-content/uploads/2018/03/hide-imgur-homepage-1-768x563.png 768w, https://swizec.com/blog/wp-content/uploads/2018/03/hide-imgur-homepage-1-1024x750.png 1024w\" sizes=\"(max-width: 2178px) 100vw, 2178px\" /><p class=\"wp-caption-text\">HideImgur replaces the homepage with useful tips</p></div></a></p>\n<p>You can see <a href=\"https://github.com/Swizec/hide-imgur-homepage\">the code on GitHub</a> and watch the <a href=\"#\">livecoding video üëÜ</a> to see how it&#8217;s built.</p>\n<p>Here&#8217;s the process for building and launching your Chrome extension in a nutshell. üëá</p>\n<h2>Create an extension</h2>\n<p><a href=\"https://developer.chrome.com/extensions/getstarted\">Google&#8217;s official getting started tutorial</a> is great. You should skim it whenever you get stuck.</p>\n<p>First, you&#8217;ll need to create a directory and a <code>manifest.json</code> file.</p>\n<pre lang=\"javascript\">\n{\n    \"manifest_version\": 2,\n    \"name\": \"Hide imgur homepage\",\n    \"version\": \"1.1\",\n    \"description\":\n        \"Replace the Imgur homepage with tips for taking a healthy break. New tip every time you slack.\",\n    \"icons\": {\n        \"16\": \"icon16.png\",\n        \"48\": \"icon48.png\",\n        \"128\": \"icon128.png\"\n    },\n    \"content_scripts\": [\n        {\n            \"matches\": [\"*://imgur.com/*\"],\n            \"js\": [\"hide-imgur.js\"],\n            \"css\": [\"hide-imgur.css\"],\n            \"run_at\": \"document_start\"\n        }\n    ],\n    \"permissions\": [\"tabs\", \"*://imgur.com/*\"]\n}\n</pre>\n<p>It&#8217;s a JSON config file that tells Chrome how your extension is supposed to work. The important parts are üëá</p>\n<ol>\n<li><code>manifest_version</code>, <code>name</code>, and <code>version</code> are all required. You need those for your extension to work at all.</li>\n<li><code>description</code> is useful but not crazy important. I&#8217;m not even sure where it shows up for the user.</li>\n<li>You need 3 <code>icons</code> for various places Chrome puts them. You should make a simple image and resize it to 16&#215;16, 48&#215;48, and 128&#215;128 pixels.</li>\n</ol>\n<p>You&#8217;ve created a Chrome extension! Congratz üñê</p>\n<p>Not very useful yet. I wanted mine to get permissions for <code>imgur.com</code> and run <code>content_scripts</code> when you open that page.</p>\n<p>That&#8217;s defined in <code>content_scripts</code> and <code>permissions</code>. The first tells Chrome which files to load when the URL matches <code>imgur.com</code> and when it should run.</p>\n<p><code>document_start</code> lets you run scripts <em>before</em> the page is loaded. Avoids a lot of content flicker.</p>\n<p><code>permissions</code> aspecifies which permsissinos you want to ask for. The fewer you ask for the more your users will like you.</p>\n<p>Nobody likes to see that &#8220;X asks for permission to access all your sites&#8221; notifications. Are you a keylogger?</p>\n<p>PS: You could totally build a keylogger like this. Please don&#8217;t.</p>\n<div id=\"attachment_8275\" style=\"width: 974px\" class=\"wp-caption alignnone\"><img class=\"alignnone size-full wp-image-8275\" src=\"https://swizec.com/blog/wp-content/uploads/2018/03/permissions-screenshot-3.png\" alt=\"Hideimgur.com asks for permissions to imgur\" width=\"964\" height=\"348\" srcset=\"https://swizec.com/blog/wp-content/uploads/2018/03/permissions-screenshot-3.png 964w, https://swizec.com/blog/wp-content/uploads/2018/03/permissions-screenshot-3-300x108.png 300w, https://swizec.com/blog/wp-content/uploads/2018/03/permissions-screenshot-3-768x277.png 768w\" sizes=\"(max-width: 964px) 100vw, 964px\" /><p class=\"wp-caption-text\">Hideimgur.com asks for permissions to imgur</p></div>\n<h2>Write some JavaScript</h2>\n<p>You can <a href=\"https://developer.chrome.com/extensions/devguide\">do a lot of things with Chrome extensions</a>. Everything from changing the default new tab to adding window dialogs.</p>\n<p>For Imgur hiding, we need a content script. It‚Äôs the simplest Chrome extension to build, I think. A JavaScript file that runs in the context of a page.</p>\n<p>The fun part is avoiding frameworks.</p>\n<p>The <a href=\"https://swizec.com/blog/building-interactive-dom-benchmark-preliminary-results/swizec/8219\">DOM is fast these days</a> and pretty easy to use. Here&#8217;s a function that hides an element on the page whether it&#8217;s loaded yet or not. Remember, we&#8217;re running <em>before</em> the DOM is done loading.</p>\n<pre lang=\"javascript\">\n// hide-imgur.js\nfunction hideElement(query) {\n    let el = document.querySelector(query);\n    if (el) {\n        el.style.visibility = \"hidden\";\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction hideAsync(query) {\n    const hidden = hideElement(query);\n\n    if (!hidden) {\n        setTimeout(function() {\n            hideAsync(query);\n        }, 100);\n    } else {\n        putUpSomeContent();\n    }\n}\n</pre>\n<p>In <code>hideElement</code>, we look for a DOM node. If it&#8217;s found, we set its <code>visibility</code> to <code>hidden</code> and return <code>true</code>. Otherwise, we say nothing happened.</p>\n<p>It&#8217;s important to toggle visibility instead of the usual <code>display: none</code> because it avoids removing the node, just hides it. We want to avoid removing the node because if we collapse the page to zero height, Imgur&#8217;s infinite scroll falls into an infinite loop and eats all our CPU.</p>\n<p>That was fun to discover üòÖ</p>\n<p><code>hideAsync</code> is a wrapper on top of <code>hideElement</code> that waits until nodes are rendered before hiding them. Takes a query, calls <code>hideElement</code>, if nothing happens it waits <code>100</code> milliseconds then tries again.</p>\n<p>If hiding worked, it runs the function that puts healthy tips on the page.</p>\n<p>Finally, we loop through all distracting elements of Imgur and hide them in a loop üëá</p>\n<pre lang=\"javascript\">\n// hide-imgur.js\n\n// Go through dangerouns elements and hide them\n[\n    \"#imagelist\",\n    \"#top-comments\",\n    \".sentence-sorting\",\n    \"#right-content\",\n    \"#extended-imagelist\",\n    \".next-prev\"\n].forEach(hideAsync);\n</pre>\n<p>You can find those elements with the Elements tab of your Chrome dev tools. The key is to find the topmost node that wraps all the content, but doesn&#8217;t wrap too much of the content.</p>\n<p>Bit of an art. And it&#8217;s gonna break when Imgur redesigns.</p>\n<p>The definition of fragile code üòõ</p>\n<img src=\"https://media.giphy.com/media/Xra0ADZp25hBK/giphy.gif\" />\n<h2>Launch</h2>\n<p>Launching your extension takes you to one of the worst designed websites I have ever seen: The <a href=\"https://chrome.google.com/webstore/developer/dashboard?pli=1&amp;authuser=1\">Chrome Web Store Developers Dashboard</a></p>\n<img class=\"alignnone size-full wp-image-8277\" src=\"https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.55.39-3.png\" width=\"1998\" height=\"1376\" srcset=\"https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.55.39-3.png 1998w, https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.55.39-3-300x207.png 300w, https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.55.39-3-768x529.png 768w, https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.55.39-3-1024x705.png 1024w\" sizes=\"(max-width: 1998px) 100vw, 1998px\" />\n<p><a href=\"https://developer.chrome.com/webstore/publish\">Detailed instructions in Google&#8217;s devguide</a></p>\n<p>You pay a $5 fee the first time you publish, upload a zip file of your directory, add some descriptions and screenshots, and you&#8217;re off to the races.</p>\n<p>Next time you search Chrome extensions, your baby will be there.</p>\n<a href=\"http://hideimgur.com\"><img src=\"https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.42.44-1-1024x126.png\" alt=\"\" class=\"alignnone size-large wp-image-8281\" srcset=\"https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.42.44-1-1024x126.png 1024w, https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.42.44-1-300x37.png 300w, https://swizec.com/blog/wp-content/uploads/2018/03/Screen-Shot-2018-03-13-at-09.42.44-1-768x95.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a>\n<p>ü§ò</p>\n<p>PS: It helps to make a nice landing page before you post to ProductHunt and places like that. I used <a href=\"https://carrd.co\">carrd.co</a> to do that.</p>\n"},"site":{"siteMetadata":{"title":"Swizec Blog","subtitle":"Fetch Data From Local WP Install"}}},"pageContext":{"id":"e77744ca-9481-5654-8b3f-a6d7d6888105"}}