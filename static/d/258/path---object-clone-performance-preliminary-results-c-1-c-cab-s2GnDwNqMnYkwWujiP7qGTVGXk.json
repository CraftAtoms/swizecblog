{"data":{"wordpressPost":{"title":"Object clone performance: preliminary results","content":"<p>Spurred by debate on <a href=\"https://swizec.com/blog/a-puzzle-in-javascript-objects/swizec/7014\">A Puzzle in JavaScript objects</a>, I wanted to find the best way to clone objects in JavaScript. In this scenario, &#8220;best&#8221; means &#8220;fastest on average&#8221;.</p>\n<p>I&#8217;m using the dataset from <a href=\"http://swizec.github.io/h1b-software-salaries/#2014-ca-engineer\">this visualization on H1B salaries</a> as a quick way to build many objects. The dataset contains 81,123 objects with 9 keys each.</p>\n<p>The experiment is set up like this:</p>\n<ul>\n<li>load &amp; parse data</li>\n<li>run clone experiments in series</li>\n<li>each experiment makes 10 deep copies of the dataset</li>\n<li>&#8220;deep&#8221; is allowed to mean just the 2 levels required (objects in array don&#8217;t contain more objects)</li>\n<li>present average runtime of each clone</li>\n</ul>\n<p>Each individual experiment uses this runner:</p>\n<pre lang=\"javascript\">\r\nrunner(name, method) {\r\n        const times = d3.range(0, this.N).map(() => {\r\n            const t1 = new Date();\r\n\r\n            let copy = method(this.state.data);\r\n\r\n            const t2 = new Date();\r\n            return t2 - t1;\r\n        });\r\n\r\n        let results = this.state.results;\r\n        results.push({name: name,\r\n                      avg: d3.mean(times)});\r\n\r\n        this.setState({results: results});\r\n    }\r\n</pre>\n<p>If you spot a problem with that setup, tell me.</p>\n<p>Preliminary results, running on my laptop in Chrome 53, are a bit strange. Iterating through the array and doing <code>Object.assign</code> is fastest, and <code>_.cloneDeep</code> is slowest. </p>\n<figure>\n<img src=\"http://i.imgur.com/N1i7cv6.png\" alt=\"\" /><br />\n</figure>\n<p>I want to add a more context-aware Lodash approach, Immutable.js, and a few different browsers. Then make some graphs ðŸ™‚</p>\n<p>What&#8217;s your favorite way to clone objects in JavaScript? I&#8217;ll add it to the test.</p>\n"},"site":{"siteMetadata":{"title":"Swizec Blog","subtitle":"Fetch Data From Local WP Install"}}},"pageContext":{"id":"a5b2ca11-cb06-58a1-a553-627d0ecfe580"}}