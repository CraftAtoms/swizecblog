{"data":{"wordpressPost":{"title":"Livecoding Recap 50: How newbie mistakes kill the flow","content":"<p><em>This is a Livecoding Recap â€“ an almost-weekly post about interesting things discovered while livecoding. Usually shorter than 500 words. Often with pictures. Livecoding happens almost <strong>every Sunday at 2pm PDT</strong> on multiple channels. You should follow <a href=\"https://www.youtube.com/TheSwizec\">My Youtube</a> channel to catch me live.</em></p>\n<p><iframe width=\"580\" height=\"326\" src=\"https://www.youtube.com/embed/7PVF41QHIK0?feature=oembed\" frameborder=\"0\" gesture=\"media\" allowfullscreen></iframe></p>\n<p>Ah, it&#8217;s good to be back. It&#8217;s been what, a month? Long time no see as the first person to say hi in the chatroom said.</p>\n<p>We continued to work on <a href=\"https://github.com/gatsbyjs/gatsby\">GatsbyJS</a>. That one feature I want to add: Make links in markdown tables of contents absolute.</p>\n<p>Instead of <code>#some-title</code> the link should be <code>/page-slug#some-title</code>. That way users can put tables of contents on their index pages and link into documents directly.</p>\n<p>The first difficulty was <a href=\"https://swizec.com/blog/wont-be-switching-vscode/swizec/7898\">using VSCode</a>. I wanted to give it a fairer shot at impressing me after all the configuration advice people gave me on Friday.</p>\n<p>Also, this killer feature looks cool and I want it.</p>\n<blockquote class=\"twitter-tweet\" data-width=\"550\">\n<p lang=\"en\" dir=\"ltr\">plus then you can slowly learn to become hopelessly dependent on this feature: <a href=\"https://t.co/U0kUwijD6j\">pic.twitter.com/U0kUwijD6j</a></p>\n<p>&mdash; Jason Miller ðŸ¦Šâš› (@_developit) <a href=\"https://twitter.com/_developit/status/926509015672160256?ref_src=twsrc%5Etfw\">November 3, 2017</a></p></blockquote>\n<p><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></p>\n<p>I&#8217;ll talk more about VSCode after I use it some more.</p>\n<p>The other difficulty was that I have no idea what I&#8217;m doing. At first, I was editing the wrong file. My code kept vanishing every time compilation did its thing.</p>\n<p>Turns out there&#8217;s a big difference between <code>gatsby-transform-remark/extend-node-type.js</code> and <code>gatsby-transform-remark/src/extend-node-type.js</code>.</p>\n<p>Confusing for a newbie that those two files are so close together, but it makes sense. Gatsby uses something called <a href=\"https://github.com/lerna/lerna\">Lerna</a> to create a multirepo. Every folder inside the repository is its own package.</p>\n<p>When I figured that out, I had the bright idea to update my local clone to latest master.</p>\n<p>It did not go so well.</p>\n<p>It went so not well, in fact, that we never got to the real work. I don&#8217;t know how many times I installed and reinstalled <code>node_modules</code>, but nothing worked.</p>\n<p>This ate all the time I had, and we got nothing done.</p>\n<p>I mean, sure, we explored how the markdown AST stuff works, where we need to add the slug (it&#8217;s deep inside children of children), and made a reasonable hypothesis that we can get the slug using <code>markdownNode.fields.slug</code>.</p>\n<p>The hypothesis stems from this: We know that each Gatsby node has a <code>fields.slug</code>. Don&#8217;t know where it comes from, but docs assure us it&#8217;s there. Not sure <code>markdownNode</code> is <em>that</em> node, but what else could it be?</p>\n<p><code>markdownNode</code> is the node that we are extending, therefore it must be the same thing as a normal Gatsby node. It&#8217;s just called <code>markdownNode</code> here because we&#8217;re operating on markdown.</p>\n<p>This is the function we&#8217;re tweaking by the way ðŸ‘‡</p>\n<pre lang=\"javascript\">\n    async function getTableOfContents(markdownNode) {\n      const cachedToc = await cache.get(tableOfContentsCacheKey(markdownNode))\n      if (cachedToc) {\n        return cachedToc\n      } else {\n        const ast = await getAST(markdownNode)\n        const tocAst = mdastToToc(ast)\n        let toc\n        if (tocAst.map) {\n          toc = hastToHTML(toHAST(tocAst.map))\n        } else {\n          toc = ``\n        }\n        cache.set(tableOfContentsCacheKey(markdownNode), toc)\n        return toc\n      }\n    }\n</pre>\n<p>That <code>tocAst</code> is where we inject our tweak. I think ðŸ¤”</p>\n<p>Oh right! The newbie mistake fix ðŸ‘‰ Matthew of Gatsby fame informed me that my <code>yarn.lock</code> was probably out of date. It was.</p>\n"},"site":{"siteMetadata":{"title":"Swizec Blog","subtitle":"Fetch Data From Local WP Install"}}},"pageContext":{"id":"b6fc4ab0-6701-527b-aaff-57250cfcb4c8"}}