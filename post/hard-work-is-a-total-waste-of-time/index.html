<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/swizecblog/component---src-components-post-js.345c7c4f16662f410581.css">@import url(https://fonts.googleapis.com/css?family=Lora);
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:Lora,serif}body{background-color:#f6f6f6;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Lora,serif;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Lora,serif;font-feature-settings:"kern","liga","clig","calt";font-kerning:normal;font-weight:400;word-wrap:break-word}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem;word-wrap:normal}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:Lora,serif;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}

/*# sourceMappingURL=component---src-components-post-js.345c7c4f16662f410581.css.map*/</style><style data-styled-components="cEsjyT hklXLQ gpHXOM cTUdjA">
/* sc-component-id: sc-bdVaJa */
.cEsjyT{margin:3rem auto;max-width:960px;padding:1.25rem 1rem;} .cEsjyT ul{margin:0 0 0px 0;list-style:none;float:right;}
/* sc-component-id: sc-bwzfXH */
.cTUdjA{-webkit-text-decoration:none;text-decoration:none;text-align:right;margin:0 .5rem 0 .5rem;padding:10px;color:#7c51a1;} .cTUdjA:hover{color:#fff;background-color:#7c51a1;}
/* sc-component-id: sc-htpNat */
.gpHXOM{-webkit-text-decoration:none;text-decoration:none;color:black;} .gpHXOM:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#7c51a1;} .gpHXOM h3{display:inline;font-size:30px;}
/* sc-component-id: sc-bxivhb */
.hklXLQ{margin:0 3rem 4.5rem;}</style><title data-react-helmet="true">Swizec Blog</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><link as="script" rel="preload" href="/swizecblog/component---src-components-post-js-a296f4540b7641f60fd0.js"/><link as="script" rel="preload" href="/swizecblog/0-7538a10af02717828d76.js"/><link as="script" rel="preload" href="/swizecblog/app-e5d3c6935dd41a7392ed.js"/><link as="script" rel="preload" href="/swizecblog/webpack-runtime-fb9019140f39a903448b.js"/><link rel="preload" href="/swizecblog/static/d/264/path---post-hard-work-is-a-total-waste-of-time-6-d-9-a50-qBPfbZgF5CS0SIkgYNHmaSe8eQQ.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div><div class="sc-bdVaJa cEsjyT"><div class="sc-bxivhb hklXLQ"><a class="sc-htpNat gpHXOM" href="/swizecblog/blog/"><h3>Swizec Teller</h3></a><ul><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Business/">Business</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Personal/">Personal</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Technical/">Technical</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Thoughts/">Thoughts</a></ul></div><h1>Hard work is a total waste of time</h1><div><div class="zemanta-img" style="margin: 1em; display: block;">
<div>
<dl class="wp-caption alignright" style="width: 310px;">
<dt class="wp-caption-dt"><a href="http://commons.wikipedia.org/wiki/File:SteacieLibrary.jpg"><img title="Steacie Science and Engineering Library at Yor..." src="http://swizec.com/blog/wp-content/uploads/2010/09/300px-SteacieLibrary.jpg" alt="Steacie Science and Engineering Library at Yor..." width="300" height="225" /></a></dt>
<dd class="wp-caption-dd zemanta-img-attribution" style="font-size: 0.8em;">Image via <a href="http://commons.wikipedia.org/wiki/File:SteacieLibrary.jpg">Wikipedia</a></dd>
</dl>
</div>
</div>
<p>Sometimes a series of great decisions can lead to a place where the best decision is a horrendously bad decision.</p>
<p>And you just don&#8217;t realise. Boole algebra taught us early in school that a chain of good implications means the next implication will be pretty good too. Then again, not really. It might be bette to take a step back, look at the bigger bigger picture and make a totally new decision.</p>
<p>Very recently, hell, yesterday, this happened to me. Something nudged me from CEO mode into developer mode. To fully analyze this we have to go back to the beginning of this summer when we embarked on The Mission with <a href="http://preona.net/" target="_blank">Preona</a> and finally started building <a href="http://lazyreadr.com/">LazyReadr </a>after months of promises and figuring out if anyone&#8217;s interested.</p>
<h3>What happen?</h3>
<p>One of the first decisions we made was to run everything on Google&#8217;s <a class="zem_slink freebase/en/google_app_engine" title="Google App Engine" rel="homepage" href="http://code.google.com/appengine/">App Engine</a>. Mostly because we saw what a pain it was keeping a <a class="zem_slink freebase/en/web_service" title="Web service" rel="wikipedia" href="http://en.wikipedia.org/wiki/Web_service">web service</a> running realiably and we are expecting there to be quite a heavy load when we have to parse a lot of articles and stuff.</p>
<p>Then somewhere in the middle of August it was time to start performing proper article <a class="zem_slink freebase/en/web_scraping" title="Web scraping" rel="wikipedia" href="http://en.wikipedia.org/wiki/Web_scraping">scraping</a> &#8211; taking a link and returning the main text without all the ads and navigation and other crap. After a few attempts with different services ranging from AlchemyAPI to a few different homebrew solutions we decided on Boilerpipe.</p>
<p>Boilerpipe is a Java library that does one thing and does it well &#8211; it extracts text from links. Great, java, so it runs on AppEngine and does what we need.</p>
<p>Fast forward two weeks and we realise that maybe this Boilerpipe thing isn&#8217;t that great after all. Everything it does is return text. But we need to know when an article has 5 pictures in it, or subtitles, links &#8230; stuff like that.</p>
<div class="zemanta-img zemanta-action-dragged" style="margin: 1em; display: block;">
<div>
<dl class="wp-caption alignright" style="width: 310px;">
<dt class="wp-caption-dt"><a href="http://commons.wikipedia.org/wiki/File:NodeJS.png"><img title="The logo of the Node.js Project from the offic..." src="http://swizec.com/blog/wp-content/uploads/2010/09/300px-NodeJS.png" alt="The logo of the Node.js Project from the offic..." width="300" height="79" /></a></dt>
<dd class="wp-caption-dd zemanta-img-attribution" style="font-size: 0.8em;">Image via <a href="http://commons.wikipedia.org/wiki/File:NodeJS.png">Wikipedia</a></dd>
</dl>
</div>
</div>
<p>Since Boilerpipe can&#8217;t do that and none of our homebrew solutions are good enough at finding content the only place left for us to go was Readability, an <a class="zem_slink" title="Arc90" rel="homepage" href="http://www.arc90.com/">Arc90</a> &#8220;experiment&#8221;, which just happens to be the best content extraction bookmarklet I have ever seen.</p>
<p>There&#8217;s a catch though. It runs on javascript and rewriting all the code into python or java so we can run it server-side just isn&#8217;t an option. Especially not when it&#8217;s apparently under active development and we&#8217;d have to go to great lengths to keep up.</p>
<p>Welcome <a class="zem_slink freebase/guid/9202a8c04000641f80000000001ec74c" title="Rhino (JavaScript engine)" rel="homepage" href="http://www.mozilla.org/rhino/">Rhino</a>. A javasript engine that runs on Java.</p>
<p>Welcome Env.js. A fake browser implemented in <a class="zem_slink freebase/en/javascript" title="JavaScript" rel="wikipedia" href="http://en.wikipedia.org/wiki/JavaScript">JavaScript</a>.</p>
<p>Combine the two and voila, we can load up a <a class="zem_slink freebase/en/website" title="Website" rel="wikipedia" href="http://en.wikipedia.org/wiki/Website">website</a> into a fake browser running within a fake javascript environment and run readability just like it was in a browser! yay!</p>
<p>Well &#8230; no. Stuff didn&#8217;t work. Env.js was too big for Java. There were bugs. Problems. Lots of stuff. I toiled heavily for three weeks or so until I finally got it working. But by god I got it working!</p>
<p>Sure it took me understanding stuff about Env.js internals I never cared about. But I got it working!</p>
<p>Exhausted, I deployed the final code onto App Engine.</p>
<p>it died</p>
<p>The whole website in browser in javascript in java was just too slow. App Engine&#8217;s 30s restriction was too much and everything just plain old died.</p>
<p>Dead end.</p>
<p>Effort wasted.</p>
<p>But then I started getting an idea. What about <a class="zem_slink freebase/en/node_js" title="Node.js" rel="homepage" href="http://nodejs.org/">node.js</a>? That&#8217;s javascript. On the server. And it&#8217;s fast! Surely I can run env.js in there and get everything working right?</p>
<p>Not exactly, but there is a project called <a href="http://github.com/tmpvar/jsdom" target="_blank">jsdom</a>.</p>
<p>Three hours later. Working web scraper. Except now it scrapes huge complex websites in a few seconds!</p>
<p>Hoorah! Then a day of patching up jsdom since it&#8217;s a youngish project and everything doesn&#8217;t work yet and we have a very sturdy scraper. Whoaw!</p>
<h3>The lesson learned</h3>
<p>expecting high load -&gt; AppEngine -&gt; Java -&gt; Rhino -&gt; Env.js -&gt; not-working-project-and-several-weeks-wasted</p>
<p>alternative:</p>
<p>node.js -&gt; jsdom -&gt; stuff-works-in-a-day-of-work</p>
<p>So I guess what I&#8217;m trying to say besides the fact I&#8217;m sooper happy I got stuff working, is that I learned my lesson and that I shouldn&#8217;t base my decisions solely on the previous decisions I&#8217;ve made. Even if all of them were good decisions by themselves.</p>
<p>PS: I&#8217;m contemplating whether we should make this service public and am leaning heavily on the Yes option. What do you guys think? Need an efficient and good web scraping API?</p>
<h6 class="zemanta-related-title" style="font-size: 1em;">Related articles by Zemanta</h6>
<ul class="zemanta-article-ul">
<li class="zemanta-article-ul-li"><a href="http://blog.nodejitsu.com/jsdom-jquery-in-5-lines-on-nodejs">Using jQuery and node.js to scrape html pages in 5 lines</a> (nodejitsu.com)</li>
</ul>
<div class="zemanta-pixie" style="margin-top: 10px; height: 15px;"><a class="zemanta-pixie-a" title="Enhanced by Zemanta" href="http://www.zemanta.com/"><img class="zemanta-pixie-img" style="border: none; float: right;" src="http://img.zemanta.com/zemified_e.png?x-id=4671db4b-1c09-4cc2-9c53-825c17a80c65" alt="Enhanced by Zemanta" /></a><span class="zem-script more-related more-info pretty-attribution"><script src="http://static.zemanta.com/readside/loader.js" type="text/javascript"></script></span></div>
</div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-components-post-js","jsonName":"post-hard-work-is-a-total-waste-of-time-6d9","path":"/post/hard-work-is-a-total-waste-of-time/"};window.dataPath="264/path---post-hard-work-is-a-total-waste-of-time-6-d-9-a50-qBPfbZgF5CS0SIkgYNHmaSe8eQQ";/*]]>*/</script><script src="/swizecblog/webpack-runtime-fb9019140f39a903448b.js" async=""></script><script src="/swizecblog/app-e5d3c6935dd41a7392ed.js" async=""></script><script src="/swizecblog/0-7538a10af02717828d76.js" async=""></script><script src="/swizecblog/component---src-components-post-js-a296f4540b7641f60fd0.js" async=""></script></body></html>