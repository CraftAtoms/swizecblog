<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/swizecblog/component---src-components-post-js.345c7c4f16662f410581.css">@import url(https://fonts.googleapis.com/css?family=Lora);
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:Lora,serif}body{background-color:#f6f6f6;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Lora,serif;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Lora,serif;font-feature-settings:"kern","liga","clig","calt";font-kerning:normal;font-weight:400;word-wrap:break-word}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem;word-wrap:normal}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:Lora,serif;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}

/*# sourceMappingURL=component---src-components-post-js.345c7c4f16662f410581.css.map*/</style><style data-styled-components="cEsjyT hklXLQ gpHXOM cTUdjA">
/* sc-component-id: sc-bdVaJa */
.cEsjyT{margin:3rem auto;max-width:960px;padding:1.25rem 1rem;} .cEsjyT ul{margin:0 0 0px 0;list-style:none;float:right;}
/* sc-component-id: sc-bwzfXH */
.cTUdjA{-webkit-text-decoration:none;text-decoration:none;text-align:right;margin:0 .5rem 0 .5rem;padding:10px;color:#7c51a1;} .cTUdjA:hover{color:#fff;background-color:#7c51a1;}
/* sc-component-id: sc-htpNat */
.gpHXOM{-webkit-text-decoration:none;text-decoration:none;color:black;} .gpHXOM:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#7c51a1;} .gpHXOM h3{display:inline;font-size:30px;}
/* sc-component-id: sc-bxivhb */
.hklXLQ{margin:0 3rem 4.5rem;}</style><title data-react-helmet="true">Swizec Blog</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><link as="script" rel="preload" href="/swizecblog/component---src-components-post-js-9d5fb6538e5aeddeb728.js"/><link as="script" rel="preload" href="/swizecblog/0-ed8d8080a34ece5ef8f5.js"/><link as="script" rel="preload" href="/swizecblog/app-8e5a12ea225b4ed6ef6a.js"/><link as="script" rel="preload" href="/swizecblog/webpack-runtime-5246e3ca1a8c4f82e8dd.js"/><link rel="preload" href="/swizecblog/static/d/526/path---post-advent-code-day-13-packet-scanners-eab-f19-dGlVImTinAuj54NivdOUpdbMZJo.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div><div class="sc-bdVaJa cEsjyT"><div class="sc-bxivhb hklXLQ"><a class="sc-htpNat gpHXOM" href="/swizecblog/blog/"><h3>Swizec Teller</h3></a><ul><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Business/">Business</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Personal/">Personal</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Technical/">Technical</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Thoughts/">Thoughts</a></ul></div><h1>Advent of Code Day 13, Packet Scanners</h1><div><p><iframe width="580" height="326" src="https://www.youtube.com/embed/3abrq1N5ITU?feature=oembed" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe></p>
<p><a href="https://adventofcode.com/">Advent of Code</a> is an advent calendar for coders. A daily puzzle that exercises that algorithmic part of coding that you don&#8217;t usually get to use in day to day programming.</p>
<p>Here&#8217;s what mine looks like right now üëá</p>
<img class="alignnone size-full wp-image-7960" src="https://swizec.com/blog/wp-content/uploads/2017/12/Screen-Shot-2017-12-13-at-08.14.34-inline.png" width="800" height="711" srcset="https://swizec.com/blog/wp-content/uploads/2017/12/Screen-Shot-2017-12-13-at-08.14.34-inline.png 800w, https://swizec.com/blog/wp-content/uploads/2017/12/Screen-Shot-2017-12-13-at-08.14.34-inline-300x267.png 300w, https://swizec.com/blog/wp-content/uploads/2017/12/Screen-Shot-2017-12-13-at-08.14.34-inline-768x683.png 768w" sizes="(max-width: 800px) 100vw, 800px" />
<p>The game works like this: Every day at midnight, a new puzzle opens up. It follows a storyline of traveling through a computer. You start with some memory access, go through registers and CPUs, and on Day 13, we dealt with some firewalls.</p>
<p><a href="https://www.youtube.com/playlist?list=PLF8WgaD4xmjWaUkBRoQiYGCV3WSKRH0pU">I&#8217;ve been playing with it</a> in Haskell and Python. Python because it&#8217;s perfect for algorithmic puzzles like this, Haskell because I wanted to brush up. Been years since I did Haskell. I miss Haskell.</p>
<p>JavaScript is clunky for this sort of thing. ü§∑‚Äç‚ôÄÔ∏è</p>
<p>You can <a href="https://github.com/Swizec/advent-of-code-2017">see my code on Github</a>. You should join my leaderboard, too. Some friendly competition that I am currently losing. üëâ <code>193241-e9880d10</code></p>
<h2>Packet Scanners in Haskell</h2>
<p>On Day 13, we had to fly through a firewall without getting found by the scanners.</p>
<blockquote><p>
You need to cross a vast firewall. The firewall consists of several layers, each with a security scanner that moves back and forth across the layer. To succeed, you must not be detected by a scanner.
</p></blockquote>
<blockquote><p>
By studying the firewall briefly, you are able to record (in your puzzle input) the depth of each layer and the range of the scanning area for the scanner within it, written as depth: range. Each layer has a thickness of exactly 1. A layer at depth 0 begins immediately inside the firewall; a layer at depth 1 would start immediately after that.
</p></blockquote>
<p>Visually that looks like this:</p>
<pre><code>Picosecond 0:
 0   1   2   3   4   5   6
[S] [S] ... ... [S] ... [S]
[ ] [ ]         [ ]     [ ]
[ ]             [ ]     [ ]
                [ ]     [ ]
</code></pre>
<p>Vertical columns are the firewall layers, <code>S</code> symbols are the packet scanners. Each picosecond they move down by <code>1</code>. At the bottom, they bounce back.</p>
<p>We move one layer to the right on each picosecond. Always on the top row. Each time we are seen by a scanner (same position at same time), it adds <code>depth*range</code> to our travel cost.</p>
<h3>Star 1</h3>
<p>For the first star, we have to calculate how much it costs to get through the scanner.</p>
<p>Rather than simulate the firewall and our travel through it, we can rely on two key insights:</p>
<ol>
<li>The depth of a layer is the same as the number of picoseconds it takes to get to it. Layer 0 is at 0 picoseconds, layer 10 at 10, 90 at 90, and so on.</li>
<li>Scanners return to their 0th position periodically. We can calculate if a scanner is at 0 for any particular picosecond.</li>
</ol>
<p>Finding the series formula for #2 was the tricky part because I suck at finding series formulas by inference. This is the pattern üëá</p>
<pre><code>A scanner with range 1, is at 0 every 1 picosecond.

With range 2, every 2 picoseconds
3, every 4 picoseconds
4, every 6 picoseconds
5, every 8
6, every 10
...
</code></pre>
<p>You might find it obvious, but it wrinkled my brain six ways to Sunday. A scanner returns to 0 every <code>range*2-2</code> picoseconds.</p>
<p>That means we can see if a scanner is at zero at any particular time by checking the modulus with time üëâ <code>time % (range*2-2) == 0</code></p>
<p>Since we know we reach each layer at the depth of that layer, we can substitute <code>time</code> for <code>depth</code> and calculate the cost, or severity, at each layer with this function üëá</p>
<pre lang="haskell">
severity::(Int, Int) -> Int
severity (depth, range)
    | mod depth (range*2-2) == 0 = depth * range
    | otherwise = 0
</pre>
<p><code>severity</code> takes a tuple of two integers, a depth and a range, and checks if the scanner on that layer is at position <code>0</code> when we reach it. If it is, it returns <code>depth*range</code> the cost of getting caught; otherwise, it returns <code>0</code>. No cost.</p>
<p>We can then use this function to <code>sum</code> the cost of our entire trip.</p>
<pre lang="haskell">
star1::[String] -> Int
star1 input = sum $ map severity $ prepInput input
</pre>
<p><code>star</code> takes a list of strings and returns an integer. First, it parses the list of strings into a list of <code>(depth, range)</code> tuples. That&#8217;s <code>prepInput</code>, and it&#8217;s <a href="https://github.com/Swizec/advent-of-code-2017/blob/master/13.hs#L50">not very interesting</a>.</p>
<p>After the input is parsed, we <code>map</code> through with the <code>severity</code> function to get a list of costs for every layer, and <code>sum</code> them up. That&#8217;s our result.</p>
<h3>Star 2</h3>
<p>Star 2 adds an interesting twist to the story. We have to avoid getting caught.</p>
<blockquote><p>
Now, you need to pass through the firewall without being caught &#8211; easier said than done.
</p></blockquote>
<blockquote><p>
You can&#8217;t control the speed of the packet, but you can delay it any number of picoseconds. For each picosecond you delay the packet before beginning your trip, all security scanners move one step. You&#8217;re not in the firewall during this time; you don&#8217;t enter layer 0 until you stop delaying the packet.
</p></blockquote>
<p>Our goal is to find the smallest delay that gets us through the firewall uncaught.</p>
<p>Uncaught is the same as cost of the trip being 0. That means we can use the <code>severity</code> function from before.</p>
<p>Since we think of each layer&#8217;s depth as the picosecond when we reach that layer, we can fake the delay by making the entire firewall deeper. That means adding <code>+1</code> to every layer until the cost of our trip becomes zero.</p>
<pre lang="haskell">
smallestDelay::[(Int, Int)] -> Int
smallestDelay input
    | sum severities == 0 = delay
    | otherwise = smallestDelay $ map (\(a,b) -> (a+1, b)) input
    where severities = map severity input
          (delay, _) = head input
</pre>
<p><code>smallestDelay</code> takes a list of <code>(depth, range)</code> tuples and returns an integer. If the <code>sum severities</code> (cost of our trip) is <code>0</code>, we return the current delay; otherwise, we construct a new faux firewall whose layers are shifted by <code>+1</code>.</p>
<p>Each time we do this, we use <code>map severity input</code> to get a list of costs and take the <code>head</code> of our input firewall to see the delay. Since we&#8217;re shifting the whole firewall, the &#8220;depth&#8221; of the first layer represents our delay.</p>
<p>And that&#8217;s the solution in Haskell ü§ì</p>
<p>Happy hacking.</p>
<p>PS: in <a href="https://www.youtube.com/watch?v=3abrq1N5ITU">the video</a>, you can see me trying to solve Day 12 as well. That&#8217;s because I&#8217;m behind and playing catchup.</p>
</div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-components-post-js","jsonName":"post-advent-code-day-13-packet-scanners-eab","path":"/post/advent-code-day-13-packet-scanners/"};window.dataPath="526/path---post-advent-code-day-13-packet-scanners-eab-f19-dGlVImTinAuj54NivdOUpdbMZJo";/*]]>*/</script><script src="/swizecblog/webpack-runtime-5246e3ca1a8c4f82e8dd.js" async=""></script><script src="/swizecblog/app-8e5a12ea225b4ed6ef6a.js" async=""></script><script src="/swizecblog/0-ed8d8080a34ece5ef8f5.js" async=""></script><script src="/swizecblog/component---src-components-post-js-9d5fb6538e5aeddeb728.js" async=""></script></body></html>