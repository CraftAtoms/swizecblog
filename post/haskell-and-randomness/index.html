<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/swizecblog/component---src-components-post-js.345c7c4f16662f410581.css">@import url(https://fonts.googleapis.com/css?family=Lora);
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:Lora,serif}body{background-color:#f6f6f6;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Lora,serif;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Lora,serif;font-feature-settings:"kern","liga","clig","calt";font-kerning:normal;font-weight:400;word-wrap:break-word}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem;word-wrap:normal}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:Lora,serif;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}

/*# sourceMappingURL=component---src-components-post-js.345c7c4f16662f410581.css.map*/</style><style data-styled-components="cEsjyT hklXLQ gpHXOM cTUdjA">
/* sc-component-id: sc-bdVaJa */
.cEsjyT{margin:3rem auto;max-width:960px;padding:1.25rem 1rem;} .cEsjyT ul{margin:0 0 0px 0;list-style:none;float:right;}
/* sc-component-id: sc-bwzfXH */
.cTUdjA{-webkit-text-decoration:none;text-decoration:none;text-align:right;margin:0 .5rem 0 .5rem;padding:10px;color:#7c51a1;} .cTUdjA:hover{color:#fff;background-color:#7c51a1;}
/* sc-component-id: sc-htpNat */
.gpHXOM{-webkit-text-decoration:none;text-decoration:none;color:black;} .gpHXOM:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#7c51a1;} .gpHXOM h3{display:inline;font-size:30px;}
/* sc-component-id: sc-bxivhb */
.hklXLQ{margin:0 3rem 4.5rem;}</style><title data-react-helmet="true">Swizec Blog</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><link as="script" rel="preload" href="/swizecblog/component---src-components-post-js-dbedf083f25f7ad1f3b1.js"/><link as="script" rel="preload" href="/swizecblog/0-f215691c134019ee6fa5.js"/><link as="script" rel="preload" href="/swizecblog/app-49ff0b4ea28eff25fc3b.js"/><link as="script" rel="preload" href="/swizecblog/webpack-runtime-b34af8fd410bb07c9828.js"/><link rel="preload" href="/swizecblog/static/d/852/path---post-haskell-and-randomness-c-3-d-270-d3r1NgHJEnhcutcw7nS1dgJVA4.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div><div class="sc-bdVaJa cEsjyT"><div class="sc-bxivhb hklXLQ"><a class="sc-htpNat gpHXOM" href="/swizecblog/"><h3>Swizec Teller</h3></a><ul><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Business/">Business</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Personal/">Personal</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Technical/">Technical</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Thoughts/">Thoughts</a></ul></div><h1>Haskell and randomness</h1><div><p>I finally started writing code for my <a href="http://swizec.github.com/Le-Thesis/" target="_blank">thesis</a>. Hooray!</p>
<div style="width: 310px" class="wp-caption alignright"><a href="http://en.wikipedia.org/wiki/File:Haskell_wiki.JPG" target="_blank"><img class="zemanta-img-inserted zemanta-img-configured" title="A row of businesses in downtown Haskell." src="http://upload.wikimedia.org/wikipedia/en/thumb/8/89/Haskell_wiki.JPG/300px-Haskell_wiki.JPG" alt="A row of businesses in downtown Haskell." width="300" height="225" /></a><p class="wp-caption-text">A row of businesses in downtown Haskell. (Photo credit: Wikipedia)</p></div>
<p>To get my feet wet I decided to write a basic framework for <a class="zem_slink" title="Evolutionary algorithm" href="http://en.wikipedia.org/wiki/Evolutionary_algorithm" rel="wikipedia" target="_blank">evolutionary algorithms</a> in <a class="zem_slink" title="Haskell (programming language)" href="http://haskell.org" rel="homepage" target="_blank">Haskell</a>. Nothing too major, just a way to easily assemble different evaluation, mutation and selection functions.</p>
<p>For starters I&#8217;m going to evolve a <em>&#8220;<a class="zem_slink" title="Hello world program" href="http://en.wikipedia.org/wiki/Hello_world_program" rel="wikipedia" target="_blank">Hello World!</a>&#8220;</em> string. How hard could it be? Took me <a href="http://swizec.com/blog/evolving-a-poem-with-an-hour-of-python-hacking/swizec/1505" target="_blank">an hour to evolve a poem in python</a> based on character mutations &#8230;</p>
<p>Turns out it&#8217;s a lot more difficult to do in Haskell.</p>
<p>Trouble starts as soon as you try generating a random population, because getting random numbers in Haskell is somewhat involved. Or rather, it looks scarily involved at first.</p>
<h2>Random Generators</h2>
<p>The main problem comes from how <a class="zem_slink" title="Pseudorandom number generator" href="http://en.wikipedia.org/wiki/Pseudorandom_number_generator" rel="wikipedia" target="_blank">pseudo-random</a> generators work. Essentially you start with a <em>seed</em> &#8211; it can be anything, I hear current time is a good starting seed &#8211; then every time somebody needs a new random number, you perform some formula on the <em>seed</em> and get a number.</p>
<p>The next number then depends on the previous number and so on until infinity. Your garden variety recursively defined series. Not very random at all, but works well enough for most.</p>
<p>Noticed the problem?</p>
<p>Yep, random generators rely on state and state is this hated, somewhat annoying thing to handle in Haskell. Monads may sound simple, but until you get the hang of them everything looks a bit odd.</p>
<p>Oh and you wouldn&#8217;t want to pollute your whole codebase with a monad just because you want to start your whole algorithm with some random stuff, would you?</p>
<p>No you wouldn&#8217;t, it&#8217;s messy.</p>
<p>After a lot of searching (and a lot of scary suggestions), this was the cleanest solution I could find:</p>
<pre lang="haskell">
import System.Random

-- takes a random generator and returns a list of strings of 50 chars
start_population :: (RandomGen g) => g -> [[Char]]
start_population gen =
  [take 50 $ randomRs ('A', 'z') gen | x <- [0..]]

main = do
  randomGen <- newStdGen  -- get a random generator

  print $ take 2 $ start_population randomGen  -- use it as a function argument
</pre>
<p>The best part about this approach is that Haskell automatically gives you a <em>standard generator,</em> which already takes a seed from some sort of input - not sure what it uses - so your results will look reasonably random.</p>
<p>But when you want to do testing, you can just as easily do this:</p>
<pre lang="haskell">
let rand = mkStdGen 42
print $ take 2 $ randomRs ('a', 'z') rand
</pre>
<p>Which will <em>always</em> print the same two characters <em>"nd"</em>.</p>
<p>Very useful when you want to test your code actually works!</p>
<p>There's just one problem with this approach - it's very difficult to up and decide that hey, this particular function right here, should be somewhat random from now on! You now have to tell the whole system and everyone using the function, that you'd like a random generator please.</p>
<p>Whether you should want to do that without telling anyone ... well, that's a whole other story.</p>
<h6 class="zemanta-related-title" style="font-size: 1em;">Related articles</h6>
<ul class="zemanta-article-ul zemanta-article-ul-image" style="margin-left: 0; display: inline-block; list-style-type: none;">
<li class="zemanta-article-ul-li-image zemanta-article-ul-li" style="display: inline-block; vertical-align: top; text-align: left; font-size: 12px; width: 80px; height: 240px; margin: 10px 40px 20px 0px; zoom: 1; *display: inline;"><a href="http://www.r-bloggers.com/quasi-random-number-generation-in-r/" target="_blank"><img style="padding: 0; margin: 0 10px 10px 0; border: 0; display: block; box-shadow: 1px 1px 3px #999;" src="http://i.zemanta.com/noimg_05_80_80.jpg" alt="" /></a><a style="display: block; width: 80px; height: 90px; overflow: hidden; text-decoration: none; line-height: 14pt;" href="http://www.r-bloggers.com/quasi-random-number-generation-in-r/" target="_blank">Quasi-Random Number Generation in R</a>
<div style="clear: both; margin: 10px 0 10px 0;">
<hr style="margin: 0;" />
</div>
</li>
<li class="zemanta-article-ul-li-image zemanta-article-ul-li" style="display: inline-block; vertical-align: top; text-align: left; font-size: 12px; width: 80px; height: 240px; margin: 10px 40px 20px 0px; zoom: 1; *display: inline;"><a href="http://cs.stackexchange.com/questions/2576/most-efficient-algorithm-to-print-1-100-using-a-given-random-number-generator" target="_blank"><img style="padding: 0; margin: 0 10px 10px 0; border: 0; display: block; box-shadow: 1px 1px 3px #999;" src="http://i.zemanta.com/noimg_10_80_80.jpg" alt="" /></a><a style="display: block; width: 80px; height: 90px; overflow: hidden; text-decoration: none; line-height: 14pt;" href="http://cs.stackexchange.com/questions/2576/most-efficient-algorithm-to-print-1-100-using-a-given-random-number-generator" target="_blank">Most efficient algorithm to print 1-100 using a given random number generator</a>
<div style="clear: both; margin: 10px 0 10px 0;">
<hr style="margin: 0;" />
</div>
</li>
<li class="zemanta-article-ul-li-image zemanta-article-ul-li" style="display: inline-block; vertical-align: top; text-align: left; font-size: 12px; width: 80px; height: 240px; margin: 10px 40px 20px 0px; zoom: 1; *display: inline;"><a href="http://swizec.com/blog/why-i-still-havent-learned-haskell/swizec/4663" target="_blank"><img style="padding: 0; margin: 0 10px 10px 0; border: 0; display: block; box-shadow: 1px 1px 3px #999;" src="http://i.zemanta.com/94978044_80_80.jpg" alt="" /></a><a style="display: block; width: 80px; height: 90px; overflow: hidden; text-decoration: none; line-height: 14pt;" href="http://swizec.com/blog/why-i-still-havent-learned-haskell/swizec/4663" target="_blank">Why I still haven't learned Haskell</a>
<div style="clear: both; margin: 10px 0 10px 0;">
<hr style="margin: 0;" />
</div>
</li>
<li class="zemanta-article-ul-li-image zemanta-article-ul-li" style="display: inline-block; vertical-align: top; text-align: left; font-size: 12px; width: 80px; height: 240px; margin: 10px 40px 20px 0px; zoom: 1; *display: inline;"><a href="http://www.haskell.org/haskellwiki/index.php?title=Future_of_Haskell&amp;diff=46219&amp;oldid=prev" target="_blank"><img style="padding: 0; margin: 0 10px 10px 0; border: 0; display: block; box-shadow: 1px 1px 3px #999;" src="http://i.zemanta.com/noimg_16_80_80.jpg" alt="" /></a><a style="display: block; width: 80px; height: 90px; overflow: hidden; text-decoration: none; line-height: 14pt;" href="http://www.haskell.org/haskellwiki/index.php?title=Future_of_Haskell&amp;diff=46219&amp;oldid=prev" target="_blank">Future of Haskell</a>
<div style="clear: both; margin: 10px 0 10px 0;">
<hr style="margin: 0;" />
</div>
</li>
<li class="zemanta-article-ul-li-image zemanta-article-ul-li" style="display: inline-block; vertical-align: top; text-align: left; font-size: 12px; width: 80px; height: 240px; margin: 10px 40px 20px 0px; zoom: 1; *display: inline;"><a href="http://www.reddit.com/r/haskell/comments/vi425/what_are_everyones_favorite_aha_moments_in/" target="_blank"><img style="padding: 0; margin: 0 10px 10px 0; border: 0; display: block; box-shadow: 1px 1px 3px #999;" src="http://i.zemanta.com/noimg_20_80_80.jpg" alt="" /></a><a style="display: block; width: 80px; height: 90px; overflow: hidden; text-decoration: none; line-height: 14pt;" href="http://www.reddit.com/r/haskell/comments/vi425/what_are_everyones_favorite_aha_moments_in/" target="_blank">What are everyone's favorite "aha" moments in learning Haskell?</a>
<div style="clear: both; margin: 10px 0 10px 0;">
<hr style="margin: 0;" />
</div>
</li>
</ul>
<div class="zemanta-pixie" style="margin-top: 10px; height: 15px;"><a class="zemanta-pixie-a" title="Enhanced by Zemanta" href="http://www.zemanta.com/?px"><img class="zemanta-pixie-img" style="border: none; float: right;" src="http://img.zemanta.com/zemified_e.png?x-id=59e72f89-c756-45f4-96c1-5afa691394af" alt="Enhanced by Zemanta" /></a></div>
</div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-components-post-js","jsonName":"post-haskell-and-randomness-c3d","path":"/post/haskell-and-randomness/"};window.dataPath="852/path---post-haskell-and-randomness-c-3-d-270-d3r1NgHJEnhcutcw7nS1dgJVA4";/*]]>*/</script><script src="/swizecblog/webpack-runtime-b34af8fd410bb07c9828.js" async=""></script><script src="/swizecblog/app-49ff0b4ea28eff25fc3b.js" async=""></script><script src="/swizecblog/0-f215691c134019ee6fa5.js" async=""></script><script src="/swizecblog/component---src-components-post-js-dbedf083f25f7ad1f3b1.js" async=""></script></body></html>