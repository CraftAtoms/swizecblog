<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/swizecblog/component---src-components-post-js.345c7c4f16662f410581.css">@import url(https://fonts.googleapis.com/css?family=Lora);
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:Lora,serif}body{background-color:#f6f6f6;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Lora,serif;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Lora,serif;font-feature-settings:"kern","liga","clig","calt";font-kerning:normal;font-weight:400;word-wrap:break-word}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem;word-wrap:normal}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:Lora,serif;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}

/*# sourceMappingURL=component---src-components-post-js.345c7c4f16662f410581.css.map*/</style><style data-styled-components="cEsjyT hklXLQ gpHXOM cTUdjA">
/* sc-component-id: sc-bdVaJa */
.cEsjyT{margin:3rem auto;max-width:960px;padding:1.25rem 1rem;} .cEsjyT ul{margin:0 0 0px 0;list-style:none;float:right;}
/* sc-component-id: sc-bwzfXH */
.cTUdjA{-webkit-text-decoration:none;text-decoration:none;text-align:right;margin:0 .5rem 0 .5rem;padding:10px;color:#7c51a1;} .cTUdjA:hover{color:#fff;background-color:#7c51a1;}
/* sc-component-id: sc-htpNat */
.gpHXOM{-webkit-text-decoration:none;text-decoration:none;color:black;} .gpHXOM:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#7c51a1;} .gpHXOM h3{display:inline;font-size:30px;}
/* sc-component-id: sc-bxivhb */
.hklXLQ{margin:0 3rem 4.5rem;}</style><title data-react-helmet="true">Swizec Blog</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><link as="script" rel="preload" href="/swizecblog/component---src-components-post-js-dbedf083f25f7ad1f3b1.js"/><link as="script" rel="preload" href="/swizecblog/0-f215691c134019ee6fa5.js"/><link as="script" rel="preload" href="/swizecblog/app-49ff0b4ea28eff25fc3b.js"/><link as="script" rel="preload" href="/swizecblog/webpack-runtime-b34af8fd410bb07c9828.js"/><link rel="preload" href="/swizecblog/static/d/67/path---post-benchmarking-vue-642-c7d-Hi52jKzdDz9SuGGck2rEMfxTwN0.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div><div class="sc-bdVaJa cEsjyT"><div class="sc-bxivhb hklXLQ"><a class="sc-htpNat gpHXOM" href="/swizecblog/"><h3>Swizec Teller</h3></a><ul><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Business/">Business</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Personal/">Personal</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Technical/">Technical</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Thoughts/">Thoughts</a></ul></div><h1>Benchmarking Vue</h1><div><p><em>This is a Livecoding Recap â€“ an almost-weekly post about interesting things discovered while livecoding. Usually shorter than 500 words. Often with pictures. Livecoding happens almost <strong>every Sunday at 2pm PDT</strong> on multiple channels. You should subscribe to <a href="https://www.youtube.com/user/TheSwizec">My Youtube</a> channel to catch me live.</em></p>
<p><iframe width="580" height="326" src="https://www.youtube.com/embed/Ff5NiCzP0ek?feature=oembed" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></p>
<p><em>This article builds on my previous articles about <a href="https://swizec.com/blog/building-interactive-dom-benchmark-preliminary-results/swizec/8219">Building an interactive DOM benchmark</a> and <a href="https://swizec.com/blog/seamlessly-render-preact-component-react-project/swizec/8224">Adding Preact to a React project</a></em></p>
<p>I understand why people like Vue, and those people are wrong.</p>
<p>But this isn&#8217;t a rant about Vue. If you like the ease of porting your 2012-era code to a modern framework, Vue is for you. If you&#8217;re into Mustache templates, Angular directives, and love to split your code into templates, scripts, and styles just like ye olden times, Vue is perfect. Hell, if you love nothing more than to use cumbersome workarounds to avoid JavaScript classes ðŸ‘‰ Vue.</p>
<p>You do you. I built a Vue component and hated every minute of it. But it&#8217;s important to try new things.</p>
<p>It took about 2 hours to add Vue to my <a href="https://dom-benchmark.now.sh/">interactive DOM benchmark</a>. Half the time I spent  bitching about the Angular 1 style templates. The other half, I complained about 2012-era hacks designed to fake classes.</p>
<p>Oh, and it took an hour just to get it compiling.</p>
<blockquote class="twitter-tweet" data-width="550" data-dnt="true">
<p lang="en" dir="ltr">Getting started with Vue is easy they said, you&#39;ll have fun they said.</p>
<p>vue-loader installs vue-template-es2015-compiler then complains it can&#39;t find vue-template-compiler <a href="https://t.co/m0w4nmp5Tf">pic.twitter.com/m0w4nmp5Tf</a></p>
<p>&mdash; Swizec (@Swizec) <a href="https://twitter.com/Swizec/status/970435615450849280?ref_src=twsrc%5Etfw">March 4, 2018</a></p></blockquote>
<p><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>
<p>A wonderful experience all over ðŸ‘Œ</p>
<p><strong>BUT!</strong> I created my first non-trivial Vue component, a simple benchmark ðŸŽ‰</p>
<h2>My first Vue component</h2>
<div id="attachment_8239" style="width: 810px" class="wp-caption alignnone"><img class="alignnone size-full wp-image-8239" src="https://swizec.com/blog/wp-content/uploads/2018/03/component-screenshot.png" alt="The Vue benchmark component" width="800" height="284" srcset="https://swizec.com/blog/wp-content/uploads/2018/03/component-screenshot.png 800w, https://swizec.com/blog/wp-content/uploads/2018/03/component-screenshot-300x107.png 300w, https://swizec.com/blog/wp-content/uploads/2018/03/component-screenshot-768x273.png 768w" sizes="(max-width: 800px) 100vw, 800px" /><p class="wp-caption-text">The Vue benchmark component</p></div>
<p>You can see the <a href="https://github.com/Swizec/dom-benchmark/blob/master/src/benchmarks/VueBenchmark.vue">code on GitHub</a>. There are 5 buttons and a scratchpad area that renders a list of immutable nodes. Much like a chatroom or a newsfeed.</p>
<p>Buttons can <code>prepend</code>, <code>insert</code>, <code>append</code>, <code>drop</code>, and <code>remove</code> nodes. Clicks map to methods on the Vue component that manipulate a <code>nodes</code> array in data. The template renders it as a  bunch of divs.</p>
<pre lang="javascript">
<div class="row benchmark-scratchpad">
    <div v-for="k in nodes">
        {{ k }}
    </div>
</div>
</pre>
<p>That <code>v-for="k in nodes"</code> syntax is one of my least favorite parts of Vue. Brings back memories of some Angular 1 projects I worked on. Nightmares lasted months<sup><a id="ffn1" href="#fn1" class="footnote">1</a></sup>.</p>
<p>Click events call instance methods via <code>v-on:click="func"</code>. They manipulate the <code>nodes</code> array and that triggers a re-render. These methods look a lot like to their React counterparts, but cleaner because there&#8217;s no <code>setState</code> in Vue. I liked that ðŸ¤«</p>
<pre lang="javascript">
prepend() {
    this.nodes = [...this.newNodes(), ...this.nodes];
},

append() {
    this.nodes = [...this.nodes, ...this.newNodes()];
},
</pre>
<p>I think that looks more readable and makes more sense than going through <code>setState</code> in React.</p>
<p><em>However</em>, you have to define instance attributes in a <code>data:</code> key and instance methods in a <code>methods:</code> key. But you override Vue&#8217;s internal instance methods in the normal namespace. ðŸ¤¨</p>
<pre lang="javascript">
module.exports = {
    // adding attributes here does nothing
 
    data: function () {
        // this is where you define state
        return {
            nodes: [],
            start: null,
            times: [],
            // ...
        }
    },
 
    // override Vue instance methods here
 
    methods: {
        // define custom instance methods here
    }
}
</pre>
<p>Wat ðŸ¤¨</p>
<p>That&#8217;s kind of how we used to write code in the old days before JavaScript got better. Did I fall into a time machine?</p>
<p>I&#8217;ve heard you can install plugins and tweak configs to get a better approach going, but if it&#8217;s not the default in the official docs, it doesn&#8217;t exist. Ask anyone.</p>
<p>Some people like this, so here we are. It was a fun experiment, I don&#8217;t like it at all. Â¯&#92;_(ãƒ„)_/Â¯</p>
<p><strong>Oh btw</strong> we render benchmark results using Vue refs and direct DOM manipulation so as to avoid re-rendering via Vue after each render. That would be unfair.</p>
<h2>Adding Vue to a nwb-cli based project</h2>
<p>Getting Vue to compile at all was fun, too. I started the project using <a href="https://github.com/insin/nwb">nwb-cli</a>, which is not The Official Wayâ„¢. You&#8217;re supposed to use <code>vue-cli</code>, but I didn&#8217;t want to start a new project.</p>
<p>Some finagling with <code>vue-loader</code> was necessary. Two steps ðŸ‘‡</p>
<ol>
<li>install some stuff</li>
<li>tweak <code>nwb.config.js</code>.</li>
</ol>
<h3>Install some stuff</h3>
<pre><code>yarn add vue vue-loader vue-template-compiler
</code></pre>
<p>You need both <code>vue-loader</code> and <code>vue-template-compiler</code> because vue-loader actually installs <code>vue-template-es2015-compiler</code> then complains that it can&#8217;t find <code>vue-template-compiler</code>. This is confusing.</p>
<p>I installed <a href="https://github.com/akxcv/vuera">vuera</a> as well. It gives you a wrapper component so you can render Vue inside your React project. <a href="https://github.com/akxcv/vuera/blob/master/src/wrappers/Vue.js%60">Vue is kept internally autonomous</a> so it shouldn&#8217;t affect the benchmark, but it makes it easier to put all benchmarks in the same project.</p>
<pre lang="javascript">
// VueBenchmarkWrapper.js

import React from "react";
import { VueWrapper } from "vuera";
import VueBenchmark from "./VueBenchmark.vue";

export default () => <VueWrapper component={VueBenchmark} />;
</pre>
<h3>Tweak nwb.config.js</h3>
<p>After installing Vue, you have to tell Webpack how to use it. That goes in <code>nwb.config.js</code>.</p>
<pre lang="javascript">
// nwb.config.js
module.exports = {
    type: "react-app",
    webpack: {
        extra: {
            module: {
                rules: [{ 
                    test: /\.vue$/, 
                    loader: "vue-loader" 
                }]
            }
        }
    }
};
</pre>
<p>You add a rule that tells Webpack to use <code>vue-loader</code> for files ending with <code>.vue</code>. Same as a normal Webpack config file, just wrapped in <code>extra:</code> so <code>nwb</code> knows what to do.</p>
<p>This is where <code>nwb</code> shines over <code>create-react-app</code>. Extra config without eject.</p>
<h2>Next step for the DOM benchmark</h2>
<p>What I want to do next is going to blow your mind. Maybe.</p>
<p>Remember my <a href="https://swizec.com/blog/blockchain-redux-experiment-part-2/swizec/8055">blockchain-redux</a> experiment from December? I want to use it to make <a href="https://dom-benchmark.now.sh/">this DOM benchmark</a> collaborative.</p>
<p>Every time you click a button, it adds to the benchmark blockchain, distributes it to everyone, updates graphs on everyone&#8217;s page. We&#8217;re going to see how these benchmarks behave in the real world on real people&#8217;s computers.</p>
<p>That&#8217;s gonna be fun ðŸ¤˜</p>
<img src="https://media.giphy.com/media/u0v3z2iQLxyHC/giphy.gif" />
<ol id="footnotes">
<li id="fn1">This is a dramatization. There were only cold sweats every time I opened the editor to get started. <a href="#ffn1">&#8617;</a></li>
</ol>
</div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-components-post-js","jsonName":"post-benchmarking-vue-642","path":"/post/benchmarking-vue/"};window.dataPath="67/path---post-benchmarking-vue-642-c7d-Hi52jKzdDz9SuGGck2rEMfxTwN0";/*]]>*/</script><script src="/swizecblog/webpack-runtime-b34af8fd410bb07c9828.js" async=""></script><script src="/swizecblog/app-49ff0b4ea28eff25fc3b.js" async=""></script><script src="/swizecblog/0-f215691c134019ee6fa5.js" async=""></script><script src="/swizecblog/component---src-components-post-js-dbedf083f25f7ad1f3b1.js" async=""></script></body></html>