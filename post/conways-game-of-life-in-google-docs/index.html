<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/swizecblog/component---src-components-post-js.345c7c4f16662f410581.css">@import url(https://fonts.googleapis.com/css?family=Lora);
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:Lora,serif}body{background-color:#f6f6f6;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Lora,serif;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Lora,serif;font-feature-settings:"kern","liga","clig","calt";font-kerning:normal;font-weight:400;word-wrap:break-word}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem;word-wrap:normal}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:Lora,serif;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}

/*# sourceMappingURL=component---src-components-post-js.345c7c4f16662f410581.css.map*/</style><style data-styled-components="cEsjyT hklXLQ gpHXOM cTUdjA">
/* sc-component-id: sc-bdVaJa */
.cEsjyT{margin:3rem auto;max-width:960px;padding:1.25rem 1rem;} .cEsjyT ul{margin:0 0 0px 0;list-style:none;float:right;}
/* sc-component-id: sc-bwzfXH */
.cTUdjA{-webkit-text-decoration:none;text-decoration:none;text-align:right;margin:0 .5rem 0 .5rem;padding:10px;color:#7c51a1;} .cTUdjA:hover{color:#fff;background-color:#7c51a1;}
/* sc-component-id: sc-htpNat */
.gpHXOM{-webkit-text-decoration:none;text-decoration:none;color:black;} .gpHXOM:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#7c51a1;} .gpHXOM h3{display:inline;font-size:30px;}
/* sc-component-id: sc-bxivhb */
.hklXLQ{margin:0 3rem 4.5rem;}</style><title data-react-helmet="true">Swizec Blog</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><link as="script" rel="preload" href="/swizecblog/component---src-components-post-js-352e8466f0cbd742adc0.js"/><link as="script" rel="preload" href="/swizecblog/0-7538a10af02717828d76.js"/><link as="script" rel="preload" href="/swizecblog/app-e5d3c6935dd41a7392ed.js"/><link as="script" rel="preload" href="/swizecblog/webpack-runtime-bf7869bd5fe0e771eaf7.js"/><link rel="preload" href="/swizecblog/static/d/772/path---post-conways-game-of-life-in-google-docs-fd-6-311-OBXhfxa7LHg7K9wKCBUOFWdvL98.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div><div class="sc-bdVaJa cEsjyT"><div class="sc-bxivhb hklXLQ"><a class="sc-htpNat gpHXOM" href="/swizecblog/"><h3>Swizec Teller</h3></a><ul><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Business/">Business</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Personal/">Personal</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Technical/">Technical</a><a class="sc-bwzfXH cTUdjA" href="/swizecblog/Thoughts/">Thoughts</a></ul></div><h1>Conway’s game of life in Google Docs</h1><div><img src="http://swizec.com/blog/wp-content/uploads/2016/08/glider.gif" alt="Conway glider" class="aligncenter size-full wp-image-6932" />
<p>Why? Because.</p>
<p>Have you really never wanted to create <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Conway&#8217;s game of life</a> in a google doc spreadsheet? Really, never? Okay, it&#8217;s a pretty weird thing to do. And it&#8217;s not as fun as I hoped.</p>
<p>You can play with it, <a href="https://docs.google.com/spreadsheets/d/1k8mT9a-Fu8x1TkvjYGtrDng8vWQAnNf01nSFCaVwqO4/edit?usp=sharing">here</a></p>
<p>I&#8217;m giving a 30min presentation on &#8220;<em>How to JavaScript</em>&#8221; to our not-engineers – the operations and business development teams. But how? It&#8217;s not like you can teach somebody JavaScript from scratch in 30 minutes. The most you can do is show them enough to want to learn more.</p>
<p>That&#8217;s easier, but still … how? You can&#8217;t just show them a bunch of for loops and functions and hope it sticks. You have to get them <em>excited</em>.</p>
<p>The answer I&#8217;m trying to answer is: <em>&#8220;How can this make my life better?&#8221;</em></p>
<p>They all spend a lot of time in Google Docs. They run a lot of day to day processes in there. Google Docs has scripting capabilities.</p>
<p>See where I&#8217;m getting at?</p>
<p>Conway&#8217;s Game of Life inside Google Docs, of course. It highlights the basics of reading and manipulating properties of individual cells in spreadsheets, and the game itself is easy to explain:</p>
<ol>
<li>Any live cell with fewer than two live neighbours dies, as if caused by under-population.</li>
<li>Any live cell with two or three live neighbours lives on to the next generation.</li>
<li>Any live cell with more than three live neighbours dies, as if by over-population.</li>
<li>Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction.</li>
</ol>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/f/f2/Game_of_life_animated_glider.gif" alt="" /><br />
</figure>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/9/95/Game_of_life_blinker.gif" alt="" /><br />
</figure>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/0/07/Game_of_life_pulsar.gif" alt="" /><br />
</figure>
<p>I showed one of them some gifs and he said <em>&#8220;Oh dude, I&#8217;m excited! That looks so cool&#8221;</em>. All the confirmation I needed to go waste 3 hours of my life figuring out how to build this! ?</p>
<p>Scripting Google Docs is hell.</p>
<p>You can&#8217;t alert, there&#8217;s no console.log, everything is slow, and ES6 works only partially. You get destructuring, but no string templates. I dared not try arrow functions.</p>
<p>Timers also don&#8217;t exist. Which means you have to manually step through the game loop by clicking a button. ?</p>
<p>One silver lining is <a href="https://github.com/peterherrmann/BetterLog">this 3rd party logger called BetterLogger</a>, which lets you <code>Logger.log</code> things to a separate sheet in your spreadsheet. It&#8217;s not very smart, but it helps a lot.</p>
<p>And if you thought DOM was slow, wait &#8217;till you try Docs access. Naively searching through 30&#215;30 cells and counting neighbors took <em>many seconds</em>. Maybe 20 seconds per game tick.</p>
<p>That can be optimized, though. Just access the spreadsheet less.</p>
<p>The first step is to set global vars and add a menu:</p>
<pre lang="javascript">
// global vars
var maxX = 30,
    maxY = 30,
    Alive = '#000000';

// almost everything needs a reference to this
var Sheet = SpreadsheetApp.getActiveSheet();

// add menu
function onOpen() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var menuItems = [
    {name: 'Step game', functionName: 'stepGame'},
    {name: 'Clear game', functionName: 'clearGame'}
  ];
  spreadsheet.addMenu('Conway\'s game of life', menuItems);
}
</pre>
<p>Docs runs this code when you open your document. It adds a menu that looks like this:</p>
<img src="http://swizec.com/blog/wp-content/uploads/2016/08/menu.png" alt="Menu" class="aligncenter size-full wp-image-6933" srcset="https://swizec.com/blog/wp-content/uploads/2016/08/menu.png 488w, https://swizec.com/blog/wp-content/uploads/2016/08/menu-300x144.png 300w" sizes="(max-width: 488px) 100vw, 488px" />
<p><code>Step Game</code> runs an iteration of the game loop, <code>Clear Game</code> clears all cells. Black background means a living cell and white background means a not-living cell.</p>
<p>On each game step, we build a map of living cells, then run the game rules on each. Like this:</p>
<pre lang="javascript">
function stepGame() {
  var range = Sheet.getRange(1, 1, maxX, maxY);
  
  var numRows = range.getNumRows(),
      numCols = range.getNumColumns();
  
  var lifeMap = [];
  
  for (var y = 1; y <= numRows; y++) {
    lifeMap[y] = [];
    
    for (var x = 1; x <= numCols; x++) {
      lifeMap[y][x] = range.getCell(y, x).getBackground() == Alive;
    }
  }
  
  for (var y = 1; y <= numRows; y++) {
    for (var x = 1; x <= numCols; x++) {
      conwayGame(lifeMap, y, x);
    }
  }
}
</pre>
<p>You can think of the spreadsheet as 2-dimensional memory. First dimension is the row, second is the column. You can store styling information, the value itself, and notes. Docs lets you access directly on both dimension, but it&#8217;s slow.</p>
<p>Having 2D memory also means there will be a lot of these nested for loop constructs in your code. You&#8217;re limited to O(n<sup>2</sup>) algorithms at best.</p>
<p>Applying Conway rules to each cell looks like this:</p>
<pre lang="javascript">
function conwayGame(lifeMap, y, x) {
  var neighborPos = [y > 1 ? y-1 : 1, 
                     x > 1 ? x-1 : 1, 
                     y < maxY ? y+1 : maxY, 
                     x < maxX ? x+1: maxX]
  
  var livingNeighbors = countLife(lifeMap, neighborPos);
  
  if (lifeMap[y][x]) {
    livingNeighbors -= 1;
  }
  
  if ((livingNeighbors < 2 || livingNeighbors > 3) && lifeMap[y][x]) {
    deactivate(Sheet.getRange(y, x));
  }else if (livingNeighbors == 3) {
    activate(Sheet.getRange(y, x));
  }
}
</pre>
<p>We count living neighbors, discount the current cell if it&#8217;s alive, then decide whether to <code>deactivate</code> or <code>activate</code> it. Counting the neighbors literally means walking through a 3x3 array around the current cell and counting cells that have a black background.</p>
<p>Activating or deactivating is a call to <code>cell.setBackground('black')</code> and <code>cell.setBackground('white')</code>.</p>
<p>That&#8217;s kind of it … I&#8217;m embarrassed it took me 3 hours …</p>
</div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-components-post-js","jsonName":"post-conways-game-of-life-in-google-docs-fd6","path":"/post/conways-game-of-life-in-google-docs/"};window.dataPath="772/path---post-conways-game-of-life-in-google-docs-fd-6-311-OBXhfxa7LHg7K9wKCBUOFWdvL98";/*]]>*/</script><script src="/swizecblog/webpack-runtime-bf7869bd5fe0e771eaf7.js" async=""></script><script src="/swizecblog/app-e5d3c6935dd41a7392ed.js" async=""></script><script src="/swizecblog/0-7538a10af02717828d76.js" async=""></script><script src="/swizecblog/component---src-components-post-js-352e8466f0cbd742adc0.js" async=""></script></body></html>