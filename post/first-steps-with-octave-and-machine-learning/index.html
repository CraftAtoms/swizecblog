<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/swizecwp/component---src-components-post-js.a8953a73f94ec29b14b1.css">@import url(https://fonts.googleapis.com/css?family=Lora);
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:Lora,serif}body{background-color:#f6f6f6;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Lora,serif;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Lora,serif;font-feature-settings:"kern","liga","clig","calt";font-kerning:normal;font-weight:400;word-wrap:break-word}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:Lora,serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem;word-wrap:normal}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:Lora,serif;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}

/*# sourceMappingURL=component---src-components-post-js.a8953a73f94ec29b14b1.css.map*/</style><style data-styled-components="cEsjyT hklXLQ gpHXOM cTUdjA">
/* sc-component-id: sc-bdVaJa */
.cEsjyT{margin:3rem auto;max-width:960px;padding:1.25rem 1rem;} .cEsjyT ul{margin:0 0 0px 0;list-style:none;float:right;}
/* sc-component-id: sc-bwzfXH */
.cTUdjA{-webkit-text-decoration:none;text-decoration:none;text-align:right;margin:0 .5rem 0 .5rem;padding:10px;color:#7c51a1;} .cTUdjA:hover{color:#fff;background-color:#7c51a1;}
/* sc-component-id: sc-htpNat */
.gpHXOM{-webkit-text-decoration:none;text-decoration:none;color:black;} .gpHXOM:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#7c51a1;} .gpHXOM h3{display:inline;font-size:30px;}
/* sc-component-id: sc-bxivhb */
.hklXLQ{margin:0 3rem 4.5rem;}</style><title data-react-helmet="true">Swizec Blog</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><link as="script" rel="preload" href="/swizecwp/component---src-components-post-js-f2c2d6ca006cef019723.js"/><link as="script" rel="preload" href="/swizecwp/0-ce760dfe358fb4e73f84.js"/><link as="script" rel="preload" href="/swizecwp/app-affbd460d24d53f1fc4a.js"/><link as="script" rel="preload" href="/swizecwp/webpack-runtime-7742d5ce65cd19570880.js"/><link rel="preload" href="/swizecwp/static/d/574/path---post-first-steps-with-octave-and-machine-learning-86-a-6a7-ssoGh0jECaVJgfQtEUY7XGVZNQ8.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div><div class="sc-bdVaJa cEsjyT"><div class="sc-bxivhb hklXLQ"><a class="sc-htpNat gpHXOM" href="/swizecwp/"><h3>Swizec Teller</h3></a><ul><a class="sc-bwzfXH cTUdjA" href="/swizecwp/Business/">Business</a><a class="sc-bwzfXH cTUdjA" href="/swizecwp/Personal/">Personal</a><a class="sc-bwzfXH cTUdjA" href="/swizecwp/Technical/">Technical</a><a class="sc-bwzfXH cTUdjA" href="/swizecwp/Thoughts/">Thoughts</a></ul></div><h1>First steps with Octave and machine learning</h1><div><p>You know how most programmers find functional coding to be ever so slightly mind bending and how it&#8217;s somewhat difficult to wrap one&#8217;s head around working with variables whose state you cannot change and lazy evaluations and all manner of odd things?</p>
<div style="width: 310px" class="wp-caption alignright"><a href="http://commons.wikipedia.org/wiki/File:Gradient_ascent_%28surface%29.png"><img class="zemanta-img-inserted zemanta-img-configured" title="The gradient descent algorithm in action. (2: ..." src="http://swizec.com/blog/wp-content/uploads/2011/11/300px-Gradient_ascent_%28surface%29.png" alt="The gradient descent algorithm in action. (2: ..." width="300" height="246" /></a><p class="wp-caption-text">Image via Wikipedia</p></div>
<p>The thing I&#8217;ve had most trouble with and still do actually, is coding in a functionally clean manner, using more recursion, cleaner abstractions and so on. Just as I thought I was almost starting to get kind of good at this, a bunch of people proved me wrong when I <a title="Crowdsourcing elegance" href="http://swizec.com/blog/crowdsourcing-elegance/swizec/2608">crowdsourced some elegance</a>.</p>
<p>Yeah, some people are <em>really</em>Â good at this functional stuff.</p>
<p>And then one day ml-class introduced me to <a class="zem_slink" title="Optimization (mathematics)" href="http://en.wikipedia.org/wiki/Optimization_%28mathematics%29" rel="wikipedia">mathematical programming</a> with Octave. Sure, I&#8217;ve done some Octave before at school, but that was just enough to get my feet wet &#8211; basic syntax and stuff. Or maybe I just paying enough attention to really grasp the awesome things I was being shown.</p>
<p>Either way, I feel as if over the past two weeks, doing <a class="zem_slink" title="Machine learning" href="http://en.wikipedia.org/wiki/Machine_learning" rel="wikipedia">machine learning</a> homework in Octave has opened a whole new world of striving for elegance and purity in my code. If I thought functional was mindbending, this stuff is <em>ripping my face off</em>.</p>
<p>Apparently when you take a naive loop and make it into something beautiful it&#8217;s called vectorization in this field. The interesting bit here is that all you really need to perform optimization of epic proportions is some math fu, no translating the problem into something else, no looking at it from five different perspectives &#8230; just maths and then some.</p>
<p>Using the <a class="zem_slink" title="Gradient descent" href="http://en.wikipedia.org/wiki/Gradient_descent" rel="wikipedia">gradient descent</a> algorithm for <a class="zem_slink" title="Logistic regression" href="http://en.wikipedia.org/wiki/Logistic_regression" rel="wikipedia">logistic regression</a> as an example, in particular calculating the cost function:</p>
<div id="attachment_2867" style="width: 657px" class="wp-caption alignnone"><a href="http://swizec.com/blog/wp-content/uploads/2011/11/Screen-Shot-2011-11-04-at-12.32.27-PM.png"><img class="size-full wp-image-2867 " title="Professor Ng explaining the cost function" src="http://swizec.com/blog/wp-content/uploads/2011/11/Screen-Shot-2011-11-04-at-12.32.27-PM.png" alt="" width="647" height="256" srcset="https://swizec.com/blog/wp-content/uploads/2011/11/Screen-Shot-2011-11-04-at-12.32.27-PM.png 924w, https://swizec.com/blog/wp-content/uploads/2011/11/Screen-Shot-2011-11-04-at-12.32.27-PM-300x118.png 300w" sizes="(max-width: 647px) 100vw, 647px" /></a><p class="wp-caption-text">Professor Ng explaining the cost function</p></div>
<p>Although I think this might have been exactly the perfect example for the code below &#8230; it&#8217;s difficult to search through videos for this stuff.</p>
<p>The naive approach could be something like this (didn&#8217;t actually run the code):</p>
<pre lang="octave">J = 0;
for i = 1:m
  J += =y(i)*log(sigmoid(theta*X(i,:))-(1-y(i)*log(1-sigmoid(theta*X(i,:));
end

J = J/m;

for j = 1:size(theta)
   grad(j) = 0;
   for i = 1:m
      grad(j) += (sigmoid(theta*X(i,:))-y(i))*X(i,j);
   end
   grad(j) = grad(j)/m;
end</pre>
<p>But all those lops aren&#8217;t really necessary, all they are basically doing is <a class="zem_slink" title="Matrix multiplication" href="http://en.wikipedia.org/wiki/Matrix_multiplication" rel="wikipedia">matrix multiplication</a>, which gives us a nice way to vectorize the whole thing:</p>
<pre lang="octave">J = (1/m)*sum(-y'*log(sigmoid(X*theta))-(1-y')*log(1-sigmoid(X*theta)));

grad = (1/m)*(sigmoid(X*theta)-y)'*X;</pre>
<p>The difference in elegance absolutely blows my mind and I can&#8217;t wait to see what other wonders I discover through this Octave thing in the course of this semester.</p>
<p>Pretty much all my octave can be found in the <a href="https://github.com/Swizec/ml-class-homework" target="_blank">ml-class-homework repository</a>. But I&#8217;m sure I&#8217;ll end up modeling more algorithms in this thing.</p>
<h6 class="zemanta-related-title" style="font-size: 1em;">Related articles</h6>
<ul class="zemanta-article-ul">
<li class="zemanta-article-ul-li"><a href="http://flowingmotion.jojordan.org/2011/10/16/12-steps-to-running-gradient-descent-in-octave/">12 steps to running gradient descent in Octave</a> (flowingmotion.jojordan.org)</li>
<li class="zemanta-article-ul-li"><a href="http://www.r-bloggers.com/machine-learning-ex4-%e2%80%93-logistic-regression/">Machine Learning Ex4 &#8211; Logistic Regression</a> (r-bloggers.com)</li>
<li class="zemanta-article-ul-li"><a href="http://www.r-bloggers.com/machine-learning-ex-5-2-%e2%80%93-regularized-logistic-regression/">Machine Learning Ex 5.2 &#8211; Regularized Logistic Regression</a> (r-bloggers.com)</li>
</ul>
<div class="zemanta-pixie" style="margin-top: 10px; height: 15px;"><a class="zemanta-pixie-a" title="Enhanced by Zemanta" href="http://www.zemanta.com/"><img class="zemanta-pixie-img" style="border: none; float: right;" src="http://img.zemanta.com/zemified_e.png?x-id=821e177f-151f-4e6b-9a26-30e7b37cf580" alt="Enhanced by Zemanta" /></a></div>
</div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-components-post-js","jsonName":"post-first-steps-with-octave-and-machine-learning-86a","path":"/post/first-steps-with-octave-and-machine-learning/"};window.dataPath="574/path---post-first-steps-with-octave-and-machine-learning-86-a-6a7-ssoGh0jECaVJgfQtEUY7XGVZNQ8";/*]]>*/</script><script src="/swizecwp/webpack-runtime-7742d5ce65cd19570880.js" async=""></script><script src="/swizecwp/app-affbd460d24d53f1fc4a.js" async=""></script><script src="/swizecwp/0-ce760dfe358fb4e73f84.js" async=""></script><script src="/swizecwp/component---src-components-post-js-f2c2d6ca006cef019723.js" async=""></script></body></html>